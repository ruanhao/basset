#+TITLE:     Index
#+AUTHOR:    Hao Ruan
#+EMAIL:     ruanhao1116@gmail.com
#+LANGUAGE:  en
#+LINK_HOME: http://www.github.com/ruanhao
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="../css/style.css" />
#+OPTIONS:   H:2 num:nil \n:nil @:t ::t |:t ^:{} _:{} *:t TeX:t LaTeX:t
#+STARTUP:   showall

* 1, 基本原理

使用索引是有代价的，对于添加的每一索引，每次写操作（插入，更新，删除）都将消耗更多时间。这是因为当数据发生变动时，MongoDB 不仅要更新文档，还要更新集合上的所有索引。

** 1.1, 复合索引

相互反转（在每个方向上都乘以 -1 ）的索引是等价的：{"age": 1, "username": -1} 与 {"age": -1, "username": 1} 是完全一样的。


* 2, 特殊索引

** 2.1, TTL 索引

这种索引允许为每一个文档设置一个超时时间，文档超时就会被删除。\\
这种类型的索引可用于设计缓存系统。

#+BEGIN_SRC js
  db.my_collection.ensureIndex({"lastUpdated": 1},
                               {"expireAfterSecs": 60*60*24} // 24 hours
                              )
#+END_SRC