<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2019-03-04 Mon 18:14 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Grammar</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Hao Ruan">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link href="http://fonts.googleapis.com/css?family=Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet" type="text/css" />
<link href="../org-html-themes/css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Grammar</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org889b722">1. Stream</a>
<ul>
<li><a href="#org51d7625">1.1. 流的操作</a>
<ul>
<li><a href="#orgd56489a">1.1.1. filter</a></li>
<li><a href="#orgf6ad562">1.1.2. distinct</a></li>
<li><a href="#org24c8ae1">1.1.3. limit</a></li>
<li><a href="#org39c5e95">1.1.4. skip</a></li>
<li><a href="#org3d30d9e">1.1.5. map</a></li>
<li><a href="#org9394635">1.1.6. flatMap</a></li>
<li><a href="#orgc91e80f">1.1.7. reduce</a>
<ul>
<li><a href="#org50e49f2">1.1.7.1. 求和</a></li>
<li><a href="#orgcccabdf">1.1.7.2. 最大值</a></li>
<li><a href="#org28a9027">1.1.7.3. 平均值</a></li>
</ul>
</li>
<li><a href="#org9c6ab24">1.1.8. 数值流</a></li>
<li><a href="#orgbb71843">1.1.9. 构造流</a>
<ul>
<li><a href="#org07fe9d8">1.1.9.1. 由值创建流</a></li>
<li><a href="#org0dd4a72">1.1.9.2. 由数组创建流</a></li>
<li><a href="#orga4e9bc6">1.1.9.3. 由文件生成流</a></li>
<li><a href="#org09f2b43">1.1.9.4. 由函数生成流 （创建无限流）</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#org70efddb">2. Collection</a></li>
<li><a href="#org165293a">3. Lambda</a>
<ul>
<li><a href="#orgd47b2bd">3.1. 知识点</a>
<ul>
<li><a href="#org2a8b8b3">3.1.1. 谓词（Predicate）</a></li>
<li><a href="#org404a661">3.1.2. 函数式接口（Functional Interface）</a></li>
<li><a href="#org4425407">3.1.3. 常见函数式接口</a></li>
<li><a href="#org29feab4">3.1.4. 方法引用</a></li>
<li><a href="#orgaf51fd9">3.1.5. 构造方法引用</a></li>
<li><a href="#org0600fa5">3.1.6. 类型检查与推断</a></li>
<li><a href="#org574fca2">3.1.7. 特殊的 void 兼容规则</a></li>
</ul>
</li>
<li><a href="#org7c1710e">3.2. 示例代码</a>
<ul>
<li><a href="#org6070fa6">3.2.1. 方法引用</a></li>
<li><a href="#org8bb548f">3.2.2. 构造方法引用</a></li>
<li><a href="#orgaaff1b4">3.2.3. 排序</a></li>
<li><a href="#org99aa17c">3.2.4. 谓词复合 (negate, and, or)</a></li>
<li><a href="#orgaf88267">3.2.5. 函数复合</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org39c72bf">4. Optional</a>
<ul>
<li><a href="#orgb9a962a">4.1. 基本原理</a></li>
<li><a href="#orgb99e621">4.2. 代码示例</a>
<ul>
<li><a href="#org2d0b059">4.2.1. 类三元操作符</a></li>
<li><a href="#org7f2dbf0">4.2.2. 避免在 Null 对象上调用 stream()</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org889b722">1. Stream</a>
<ul>
<li><a href="#org51d7625">1.1. 流的操作</a>
<ul>
<li><a href="#orgd56489a">1.1.1. filter</a></li>
<li><a href="#orgf6ad562">1.1.2. distinct</a></li>
<li><a href="#org24c8ae1">1.1.3. limit</a></li>
<li><a href="#org39c5e95">1.1.4. skip</a></li>
<li><a href="#org3d30d9e">1.1.5. map</a></li>
<li><a href="#org9394635">1.1.6. flatMap</a></li>
<li><a href="#orgc91e80f">1.1.7. reduce</a>
<ul>
<li><a href="#org50e49f2">1.1.7.1. 求和</a></li>
<li><a href="#orgcccabdf">1.1.7.2. 最大值</a></li>
<li><a href="#org28a9027">1.1.7.3. 平均值</a></li>
</ul>
</li>
<li><a href="#org9c6ab24">1.1.8. 数值流</a></li>
<li><a href="#orgbb71843">1.1.9. 构造流</a>
<ul>
<li><a href="#org07fe9d8">1.1.9.1. 由值创建流</a></li>
<li><a href="#org0dd4a72">1.1.9.2. 由数组创建流</a></li>
<li><a href="#orga4e9bc6">1.1.9.3. 由文件生成流</a></li>
<li><a href="#org09f2b43">1.1.9.4. 由函数生成流 （创建无限流）</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#org70efddb">2. Collection</a></li>
<li><a href="#org165293a">3. Lambda</a>
<ul>
<li><a href="#orgd47b2bd">3.1. 知识点</a>
<ul>
<li><a href="#org2a8b8b3">3.1.1. 谓词（Predicate）</a></li>
<li><a href="#org404a661">3.1.2. 函数式接口（Functional Interface）</a></li>
<li><a href="#org4425407">3.1.3. 常见函数式接口</a></li>
<li><a href="#org29feab4">3.1.4. 方法引用</a></li>
<li><a href="#orgaf51fd9">3.1.5. 构造方法引用</a></li>
<li><a href="#org0600fa5">3.1.6. 类型检查与推断</a></li>
<li><a href="#org574fca2">3.1.7. 特殊的 void 兼容规则</a></li>
</ul>
</li>
<li><a href="#org7c1710e">3.2. 示例代码</a>
<ul>
<li><a href="#org6070fa6">3.2.1. 方法引用</a></li>
<li><a href="#org8bb548f">3.2.2. 构造方法引用</a></li>
<li><a href="#orgaaff1b4">3.2.3. 排序</a></li>
<li><a href="#org99aa17c">3.2.4. 谓词复合 (negate, and, or)</a></li>
<li><a href="#orgaf88267">3.2.5. 函数复合</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org39c72bf">4. Optional</a>
<ul>
<li><a href="#orgb9a962a">4.1. 基本原理</a></li>
<li><a href="#orgb99e621">4.2. 代码示例</a>
<ul>
<li><a href="#org2d0b059">4.2.1. 类三元操作符</a></li>
<li><a href="#org7f2dbf0">4.2.2. 避免在 Null 对象上调用 stream()</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="meta">
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Author</td>
<td class="org-left">Hao Ruan (haoru@cisco.com)</td>
</tr>

<tr>
<td class="org-left">Date</td>
<td class="org-left">2019-03-04 18:14:22</td>
</tr>
</tbody>
</table>
</div>


<div id="outline-container-org889b722" class="outline-2">
<h2 id="org889b722"><span class="section-number-2">1</span> <a href="https://github.com/ruanhao/java-for-fun/blob/master/src/main/java/com/hao/notes/stream/StreamExamples.java">Stream</a></h2>
<div class="outline-text-2" id="text-1">
<p>
流的使用一般包括三件事:
</p>

<ul class="org-ul">
<li>一个数据源（如集合）来执行一个查询</li>
<li>一个中间操作链，形成一条流的流水线</li>
<li>一个终端操作，执行流水线，并能生成结果</li>
</ul>
</div>


<div id="outline-container-org51d7625" class="outline-3">
<h3 id="org51d7625"><span class="section-number-3">1.1</span> 流的操作</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-orgd56489a" class="outline-4">
<h4 id="orgd56489a"><span class="section-number-4">1.1.1</span> filter</h4>
</div>

<div id="outline-container-orgf6ad562" class="outline-4">
<h4 id="orgf6ad562"><span class="section-number-4">1.1.2</span> distinct</h4>
</div>

<div id="outline-container-org24c8ae1" class="outline-4">
<h4 id="org24c8ae1"><span class="section-number-4">1.1.3</span> limit</h4>
</div>

<div id="outline-container-org39c5e95" class="outline-4">
<h4 id="org39c5e95"><span class="section-number-4">1.1.4</span> skip</h4>
</div>

<div id="outline-container-org3d30d9e" class="outline-4">
<h4 id="org3d30d9e"><span class="section-number-4">1.1.5</span> map</h4>
</div>

<div id="outline-container-org9394635" class="outline-4">
<h4 id="org9394635"><span class="section-number-4">1.1.6</span> flatMap</h4>
</div>

<div id="outline-container-orgc91e80f" class="outline-4">
<h4 id="orgc91e80f"><span class="section-number-4">1.1.7</span> reduce</h4>
<div class="outline-text-4" id="text-1-1-7">
<p>
此类查询需要将流中所有元素反复结合起来，得到一个值。这样的查询可以被归类为归约操作（将流归约成一个值）。
</p>

<p>
用函数式编程语言的术语来说，这称为折叠（fold），因为你可以将这个操作看成把一张长长的纸（流）反复折叠成一个小方块，而这就是折叠操作的结果。
</p>
</div>

<div id="outline-container-org50e49f2" class="outline-5">
<h5 id="org50e49f2"><span class="section-number-5">1.1.7.1</span> 求和</h5>
<div class="outline-text-5" id="text-1-1-7-1">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">BinaryOperator&lt;T&gt; &#29992;&#26469;&#23558;&#20004;&#20010;&#20803;&#32032;&#32467;&#21512;&#36215;&#26469;&#20135;&#29983;&#19968;&#20010;&#26032;&#20540;</span>
<span style="color: #5fafff;">int</span> <span style="color: #5fafff;">sum</span> = numbers.stream<span style="color: #ff8c00; font-size: 150%;">()</span>.reduce<span style="color: #ff8c00; font-size: 150%;">(</span>0, <span style="color: #ff1493; font-size: 140%;">(</span>a, b<span style="color: #ff1493; font-size: 140%;">)</span> -&gt; a + b<span style="color: #ff8c00; font-size: 150%;">)</span>;
<span style="color: #5fafff;">int</span> <span style="color: #5fafff;">sum</span> = numbers.stream<span style="color: #ff8c00; font-size: 150%;">()</span>.reduce<span style="color: #ff8c00; font-size: 150%;">(</span>0, Integer::sum<span style="color: #ff8c00; font-size: 150%;">)</span>;


<span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">reduce &#36824;&#26377;&#19968;&#20010;&#37325;&#36733;&#30340;&#21464;&#20307;&#65292;&#23427;&#19981;&#25509;&#21463;&#21021;&#22987;&#20540;&#65292;&#20294;&#26159;&#20250;&#36820;&#22238;&#19968;&#20010;Optional&#23545;&#35937;</span>
<span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">&#22240;&#20026;&#27969;&#20013;&#21487;&#33021;&#27809;&#26377;&#20219;&#20309;&#20803;&#32032;&#30340;&#24773;&#20917;&#65292;reduce &#25805;&#20316;&#23601;&#26080;&#27861;&#36820;&#22238;&#20854;&#21644;&#65292;&#22240;&#20026;&#23427;&#27809;&#26377;&#21021;&#22987;&#20540;</span>
<span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">&#36825;&#23601;&#26159;&#20026;&#20160;&#20040;&#32467;&#26524;&#34987;&#21253;&#35065;&#22312;&#19968;&#20010; Optional &#23545;&#35937;&#37324;&#65292;&#20197;&#34920;&#26126;&#21644;&#21487;&#33021;&#19981;&#23384;&#22312;</span>
<span style="color: #5fafff;">Optional</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Integer</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">sum</span> = numbers.stream<span style="color: #ff8c00; font-size: 150%;">()</span>.reduce<span style="color: #ff8c00; font-size: 150%;">(</span><span style="color: #ff1493; font-size: 140%;">(</span>a, b<span style="color: #ff1493; font-size: 140%;">)</span> -&gt; <span style="color: #ff1493; font-size: 140%;">(</span>a + b<span style="color: #ff1493; font-size: 140%;">)</span><span style="color: #ff8c00; font-size: 150%;">)</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcccabdf" class="outline-5">
<h5 id="orgcccabdf"><span class="section-number-5">1.1.7.2</span> 最大值</h5>
<div class="outline-text-5" id="text-1-1-7-2">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #5fafff;">Optional</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Integer</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">max</span> = numbers.stream<span style="color: #ff8c00; font-size: 150%;">()</span>.reduce<span style="color: #ff8c00; font-size: 150%;">(</span>Integer::max<span style="color: #ff8c00; font-size: 150%;">)</span>;
</pre>
</div>
</div>
</div>


<div id="outline-container-org28a9027" class="outline-5">
<h5 id="org28a9027"><span class="section-number-5">1.1.7.3</span> 平均值</h5>
<div class="outline-text-5" id="text-1-1-7-3">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #5fafff;">double</span> <span style="color: #5fafff;">avgCalories</span> = menu.stream<span style="color: #ff8c00; font-size: 150%;">()</span>.collect<span style="color: #ff8c00; font-size: 150%;">(</span>averagingInt<span style="color: #ff1493; font-size: 140%;">(</span>Dish::getCalories<span style="color: #ff1493; font-size: 140%;">)</span><span style="color: #ff8c00; font-size: 150%;">)</span>;
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org9c6ab24" class="outline-4">
<h4 id="org9c6ab24"><span class="section-number-4">1.1.8</span> 数值流</h4>
<div class="outline-text-4" id="text-1-1-8">
<p>
<code>IntStream</code> 中的 <code>map</code> 方法只能为流中的每个元素返回另一个 <code>int</code> ，
如果这不是你想要的，可以用 <code>IntStream</code> 的 <code>mapToObj</code> 方法改写它，这个方法会返回一个对象值流。
</p>

<p>
或者使用 <code>boxed</code> 方法先转换为 <code>Stream&lt;Integer&gt;</code> 。
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #5fafff;">IntStream</span> <span style="color: #5fafff;">evenNumbers</span> = IntStream.range<span style="color: #ff8c00; font-size: 150%;">(</span>1, 100<span style="color: #ff8c00; font-size: 150%;">)</span>;
<span style="color: #5fafff;">IntStream</span> <span style="color: #5fafff;">evenNumbers</span> = IntStream.rangeClosed<span style="color: #ff8c00; font-size: 150%;">(</span>1, 100<span style="color: #ff8c00; font-size: 150%;">)</span>;
</pre>
</div>
</div>
</div>


<div id="outline-container-orgbb71843" class="outline-4">
<h4 id="orgbb71843"><span class="section-number-4">1.1.9</span> 构造流</h4>
<div class="outline-text-4" id="text-1-1-9">
</div>
<div id="outline-container-org07fe9d8" class="outline-5">
<h5 id="org07fe9d8"><span class="section-number-5">1.1.9.1</span> 由值创建流</h5>
<div class="outline-text-5" id="text-1-1-9-1">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #5fafff;">Stream</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">String</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">stream</span> = Stream.of<span style="color: #ff8c00; font-size: 150%;">(</span><span style="color: #87af5f;">"Java 8 "</span>, <span style="color: #87af5f;">"Lambdas "</span>, <span style="color: #87af5f;">"In "</span>, <span style="color: #87af5f;">"Action"</span><span style="color: #ff8c00; font-size: 150%;">)</span>;
<span style="color: #5fafff;">Stream</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">String</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">emptyStream</span> = Stream.empty<span style="color: #ff8c00; font-size: 150%;">()</span>;
</pre>
</div>
</div>
</div>


<div id="outline-container-org0dd4a72" class="outline-5">
<h5 id="org0dd4a72"><span class="section-number-5">1.1.9.2</span> 由数组创建流</h5>
<div class="outline-text-5" id="text-1-1-9-2">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #5fafff;">int</span><span style="color: #ff8c00; font-size: 150%;">[]</span> <span style="color: #5fafff;">numbers</span> = <span style="color: #ff8c00; font-size: 150%;">{</span>2, 3, 5, 7, 11, 13<span style="color: #ff8c00; font-size: 150%;">}</span>;
<span style="color: #5fafff;">int</span> <span style="color: #5fafff;">sum</span> = Arrays.stream<span style="color: #ff8c00; font-size: 150%;">(</span>numbers<span style="color: #ff8c00; font-size: 150%;">)</span>.sum<span style="color: #ff8c00; font-size: 150%;">()</span>;
</pre>
</div>
</div>
</div>


<div id="outline-container-orga4e9bc6" class="outline-5">
<h5 id="orga4e9bc6"><span class="section-number-5">1.1.9.3</span> 由文件生成流</h5>
<div class="outline-text-5" id="text-1-1-9-3">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #5fafff;">Stream</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">String</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">lines</span> = Files.lines<span style="color: #ff8c00; font-size: 150%;">(</span>Paths.get<span style="color: #ff1493; font-size: 140%;">(</span><span style="color: #87af5f;">"data.txt"</span><span style="color: #ff1493; font-size: 140%;">)</span>, Charset.defaultCharset<span style="color: #ff1493; font-size: 140%;">()</span><span style="color: #ff8c00; font-size: 150%;">)</span>;
</pre>
</div>
</div>
</div>


<div id="outline-container-org09f2b43" class="outline-5">
<h5 id="org09f2b43"><span class="section-number-5">1.1.9.4</span> 由函数生成流 （创建无限流）</h5>
<div class="outline-text-5" id="text-1-1-9-4">
<p>
Stream API 提供了两个静态方法来从函数生成流: <code>Stream.iterate</code> 和 <code>Stream.generate</code> ，这两个操作可以创建所谓的无限流，
</p>

<p>
由 <code>iterate</code> 和 <code>generate</code> 产生的流会用给定的函数按需创建值，因此可以无穷无尽地计算下去。
一般来说，应该使用 <code>limit(n)</code> 来对这种流加以限制，以避免打印无穷多个值。
</p>

<div class="org-src-container">
<pre class="src src-java">Stream.iterate<span style="color: #ff8c00; font-size: 150%;">(</span>0, n -&gt; n + 2<span style="color: #ff8c00; font-size: 150%;">)</span>
    .limit<span style="color: #ff8c00; font-size: 150%;">(</span>10<span style="color: #ff8c00; font-size: 150%;">)</span>
    .forEach<span style="color: #ff8c00; font-size: 150%;">(</span>System.out::println<span style="color: #ff8c00; font-size: 150%;">)</span>;

Stream.generate<span style="color: #ff8c00; font-size: 150%;">(</span>Math::random<span style="color: #ff8c00; font-size: 150%;">)</span>
    .limit<span style="color: #ff8c00; font-size: 150%;">(</span>5<span style="color: #ff8c00; font-size: 150%;">)</span>
    .forEach<span style="color: #ff8c00; font-size: 150%;">(</span>System.out::println<span style="color: #ff8c00; font-size: 150%;">)</span>;

<span style="color: #5fafff;">IntStream</span> <span style="color: #5fafff;">ones</span> = IntStream.generate<span style="color: #ff8c00; font-size: 150%;">(</span><span style="color: #ff1493; font-size: 140%;">()</span> -&gt; 1<span style="color: #ff8c00; font-size: 150%;">)</span>;

</pre>
</div>
</div>
</div>
</div>
</div>
</div>















<div id="outline-container-org70efddb" class="outline-2">
<h2 id="org70efddb"><span class="section-number-2">2</span> <a href="https://github.com/ruanhao/java-for-fun/blob/master/src/main/java/com/hao/notes/stream/CollectionExamples.java">Collection</a></h2>
<div class="outline-text-2" id="text-2">
<p>
即 Collectors 类提供的工厂方法（例如 groupingBy )所创建的对象。主要提供三个功能:
</p>

<ul class="org-ul">
<li>将流元素归约和汇总为一个值</li>
<li>元素分组</li>
<li>元素分区</li>
</ul>
</div>
</div>


<div id="outline-container-org165293a" class="outline-2">
<h2 id="org165293a"><span class="section-number-2">3</span> Lambda</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgd47b2bd" class="outline-3">
<h3 id="orgd47b2bd"><span class="section-number-3">3.1</span> 知识点</h3>
<div class="outline-text-3" id="text-3-1">
</div>
<div id="outline-container-org2a8b8b3" class="outline-4">
<h4 id="org2a8b8b3"><span class="section-number-4">3.1.1</span> 谓词（Predicate）</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
返回 boolean 的函数
</p>
</div>
</div>


<div id="outline-container-org404a661" class="outline-4">
<h4 id="org404a661"><span class="section-number-4">3.1.2</span> 函数式接口（Functional Interface）</h4>
<div class="outline-text-4" id="text-3-1-2">
<p>
只有一个 <b>抽象</b> 方法的接口，这种类型的接口也称为 SAM 接口，即 Single Abstract Method interfaces ，主要用在 Lambda 表达式
</p>

<div class="org-src-container">
<pre class="src src-java">
<span style="color: #d7875f; font-weight: bold;">@FunctionalInterface</span>
<span style="color: #d787d7; font-weight: bold;">interface</span> <span style="color: #5fafff;">MyService</span> <span style="color: #ff8c00; font-size: 150%;">{</span>

    <span style="color: #5fafff;">void</span> <span style="color: #5fafff;">test</span><span style="color: #ff1493; font-size: 140%;">(</span><span style="color: #5fafff;">String</span> <span style="color: #5fafff;">s</span><span style="color: #ff1493; font-size: 140%;">)</span>; <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">&#19968;&#20010;&#25277;&#35937;&#26041;&#27861;</span>

    <span style="color: #d787d7; font-weight: bold;">default</span> <span style="color: #5fafff;">void</span> <span style="color: #5fafff;">defaultWork</span><span style="color: #ff1493; font-size: 140%;">()</span> <span style="color: #ff1493; font-size: 140%;">{</span>
        <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">&#20989;&#25968;&#24335;&#25509;&#21475;&#37324;&#21487;&#20197;&#21253;&#21547;&#40664;&#35748;&#26041;&#27861;</span>
    <span style="color: #ff1493; font-size: 140%;">}</span>

    <span style="color: #d787d7; font-weight: bold;">static</span> <span style="color: #5fafff;">void</span> <span style="color: #5fafff;">printHello</span><span style="color: #ff1493; font-size: 140%;">(){</span>
        <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">&#20989;&#25968;&#24335;&#25509;&#21475;&#37324;&#21487;&#20197;&#21253;&#21547;&#38745;&#24577;&#26041;&#27861;</span>
    <span style="color: #ff1493; font-size: 140%;">}</span>
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4425407" class="outline-4">
<h4 id="org4425407"><span class="section-number-4">3.1.3</span> 常见函数式接口</h4>
<div class="outline-text-4" id="text-3-1-3">
<ul class="org-ul">
<li><p>
Comparable (T, T) -&gt; int
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #d7875f; font-weight: bold;">@FunctionalInterface</span>
<span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #d787d7; font-weight: bold;">interface</span> <span style="color: #5fafff;">Comparator</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">T</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #ff8c00; font-size: 150%;">{</span>
    <span style="color: #5fafff;">int</span> <span style="color: #5fafff;">compare</span><span style="color: #ff1493; font-size: 140%;">(</span><span style="color: #5fafff;">T</span> <span style="color: #5fafff;">o1</span>, <span style="color: #5fafff;">T</span> <span style="color: #5fafff;">o2</span><span style="color: #ff1493; font-size: 140%;">)</span>;
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div></li>

<li><p>
Runnable () -&gt; void
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #d7875f; font-weight: bold;">@FunctionalInterface</span>
<span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #d787d7; font-weight: bold;">interface</span> <span style="color: #5fafff;">Runnable</span> <span style="color: #ff8c00; font-size: 150%;">{</span>
    <span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #d787d7; font-weight: bold;">abstract</span> <span style="color: #5fafff;">void</span> <span style="color: #5fafff;">run</span><span style="color: #ff1493; font-size: 140%;">()</span>;
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div></li>

<li><p>
Callable () -&gt; T
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #d787d7; font-weight: bold;">interface</span> <span style="color: #5fafff;">Callable</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">V</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #ff8c00; font-size: 150%;">{</span>
    <span style="color: #5fafff;">V</span> <span style="color: #5fafff;">call</span><span style="color: #ff1493; font-size: 140%;">()</span> <span style="color: #d787d7; font-weight: bold;">throws</span> <span style="color: #5fafff;">Exception</span>;
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div></li>

<li><p>
Predicate (T) -&gt; boolean
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #d7875f; font-weight: bold;">@FunctionalInterface</span>
<span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #d787d7; font-weight: bold;">interface</span> <span style="color: #5fafff;">Predicate</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">T</span><span style="color: #ff8c00; font-size: 150%;">&gt;{</span>
    <span style="color: #5fafff;">boolean</span> <span style="color: #5fafff;">test</span><span style="color: #ff1493; font-size: 140%;">(</span><span style="color: #5fafff;">T</span> <span style="color: #5fafff;">t</span><span style="color: #ff1493; font-size: 140%;">)</span>;
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div></li>

<li><p>
BiPredicate (T, U) -&gt; boolean
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #d7875f; font-weight: bold;">@FunctionalInterface</span>
<span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #d787d7; font-weight: bold;">interface</span> <span style="color: #5fafff;">BiPredicate</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">T</span>, <span style="color: #5fafff;">U</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #ff8c00; font-size: 150%;">{</span>
    <span style="color: #5fafff;">boolean</span> <span style="color: #5fafff;">test</span><span style="color: #ff1493; font-size: 140%;">(</span><span style="color: #5fafff;">T</span> <span style="color: #5fafff;">t</span>, <span style="color: #5fafff;">U</span> <span style="color: #5fafff;">u</span><span style="color: #ff1493; font-size: 140%;">)</span>;
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div></li>

<li><p>
Consumer (T) -&gt; void
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #d7875f; font-weight: bold;">@FunctionalInterface</span>
<span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #d787d7; font-weight: bold;">interface</span> <span style="color: #5fafff;">Consumer</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">T</span><span style="color: #ff8c00; font-size: 150%;">&gt;{</span>
    <span style="color: #5fafff;">void</span> <span style="color: #5fafff;">accept</span><span style="color: #ff1493; font-size: 140%;">(</span><span style="color: #5fafff;">T</span> <span style="color: #5fafff;">t</span><span style="color: #ff1493; font-size: 140%;">)</span>;
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div></li>

<li><p>
BiConsumer (T, U) -&gt; void
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #d7875f; font-weight: bold;">@FunctionalInterface</span>
<span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #d787d7; font-weight: bold;">interface</span> <span style="color: #5fafff;">BiConsumer</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">T</span>, <span style="color: #5fafff;">U</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #ff8c00; font-size: 150%;">{</span>
    <span style="color: #5fafff;">void</span> <span style="color: #5fafff;">accept</span><span style="color: #ff1493; font-size: 140%;">(</span><span style="color: #5fafff;">T</span> <span style="color: #5fafff;">t</span>, <span style="color: #5fafff;">U</span> <span style="color: #5fafff;">u</span><span style="color: #ff1493; font-size: 140%;">)</span>;
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div></li>

<li><p>
Function (T) -&gt; R
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #d7875f; font-weight: bold;">@FunctionalInterface</span>
<span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #d787d7; font-weight: bold;">interface</span> <span style="color: #5fafff;">Function</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">T</span>, <span style="color: #5fafff;">R</span><span style="color: #ff8c00; font-size: 150%;">&gt;{</span>
    <span style="color: #5fafff;">R</span> <span style="color: #5fafff;">apply</span><span style="color: #ff1493; font-size: 140%;">(</span><span style="color: #5fafff;">T</span> <span style="color: #5fafff;">t</span><span style="color: #ff1493; font-size: 140%;">)</span>;
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div></li>

<li><p>
UnaryOperator (T) -&gt; T
</p>

<p>
Function&lt;T, T&gt;
</p></li>

<li><p>
BiFunction (T, U) -&gt; R
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #d7875f; font-weight: bold;">@FunctionalInterface</span>
<span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #d787d7; font-weight: bold;">interface</span> <span style="color: #5fafff;">BiFunction</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">T</span>, <span style="color: #5fafff;">U</span>, <span style="color: #5fafff;">R</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #ff8c00; font-size: 150%;">{</span>
    <span style="color: #5fafff;">R</span> <span style="color: #5fafff;">apply</span><span style="color: #ff1493; font-size: 140%;">(</span><span style="color: #5fafff;">T</span> <span style="color: #5fafff;">t</span>, <span style="color: #5fafff;">U</span> <span style="color: #5fafff;">u</span><span style="color: #ff1493; font-size: 140%;">)</span>;
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div></li>

<li><p>
BinaryOperator (T, T) -&gt; T
</p>

<p>
BiBunction&lt;T, T, T&gt;
</p></li>

<li><p>
Supplier () -&gt; T
</p>
<div class="org-src-container">
<pre class="src src-java"><span style="color: #d7875f; font-weight: bold;">@FunctionalInterface</span>
<span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #d787d7; font-weight: bold;">interface</span> <span style="color: #5fafff;">Supplier</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">T</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #ff8c00; font-size: 150%;">{</span>
    <span style="color: #5fafff;">T</span> <span style="color: #5fafff;">get</span><span style="color: #ff1493; font-size: 140%;">()</span>;
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div></li>
</ul>
</div>
</div>



<div id="outline-container-org29feab4" class="outline-4">
<h4 id="org29feab4"><span class="section-number-4">3.1.4</span> 方法引用</h4>
<div class="outline-text-4" id="text-3-1-4">
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">方法引用</td>
<td class="org-left">Lambda 表达式</td>
</tr>

<tr>
<td class="org-left">ClassName::staticMethod</td>
<td class="org-left">(args) -&gt; ClassName.staticMethod(args)</td>
</tr>

<tr>
<td class="org-left">ClassName::instanceMethod</td>
<td class="org-left">(ins, args) -&gt; ins.instanceMethod(args)</td>
</tr>

<tr>
<td class="org-left">expr::instanceMethod</td>
<td class="org-left">(args) -&gt; expr.instanceMethod(args)</td>
</tr>
</tbody>
</table>
</div>
</div>


<div id="outline-container-orgaf51fd9" class="outline-4">
<h4 id="orgaf51fd9"><span class="section-number-4">3.1.5</span> 构造方法引用</h4>
<div class="outline-text-4" id="text-3-1-5">
<p>
对于一个现有构造函数，可以利用它的名称和关键字 new 来创建它的一个引用: ClassName::new <br>
它的功能与指向静态方法的引用类似
</p>
</div>
</div>


<div id="outline-container-org0600fa5" class="outline-4">
<h4 id="org0600fa5"><span class="section-number-4">3.1.6</span> 类型检查与推断</h4>
<div class="outline-text-4" id="text-3-1-6">
<ul class="org-ul">
<li>Lambda 的类型是从使用 Lambda 的上下文推断出来的</li>
<li>同一个 Lambda 表达式就可以与不同的函数式接口联系起来，只要它们的抽象方法签名能够兼容</li>
<li>Java 编译器会从上下文（目标类型）推断出用什么函数式接口来配合 Lambda 表达式</li>
</ul>
</div>
</div>


<div id="outline-container-org574fca2" class="outline-4">
<h4 id="org574fca2"><span class="section-number-4">3.1.7</span> 特殊的 void 兼容规则</h4>
<div class="outline-text-4" id="text-3-1-7">
<p>
如果一个 Lambda 的主体是一个语句表达式，它就和一个返回 void 的函数描述符兼容。<br>
例如，以下两行都是合法的，尽管 List 的 add 方法返回了一个 boolean ，而不是 Consumer 上下文 (T -&gt; void) 所要求的 void :
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #5fafff;">Predicate</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">String</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">p</span> = s -&gt; list.add<span style="color: #ff8c00; font-size: 150%;">(</span>s<span style="color: #ff8c00; font-size: 150%;">)</span>;

<span style="color: #5fafff;">Consumer</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">String</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">b</span> = s -&gt; list.add<span style="color: #ff8c00; font-size: 150%;">(</span>s<span style="color: #ff8c00; font-size: 150%;">)</span>;
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org7c1710e" class="outline-3">
<h3 id="org7c1710e"><span class="section-number-3">3.2</span> 示例代码</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-org6070fa6" class="outline-4">
<h4 id="org6070fa6"><span class="section-number-4">3.2.1</span> 方法引用</h4>
<div class="outline-text-4" id="text-3-2-1">
<div class="org-src-container">
<pre class="src src-java">str.sort<span style="color: #ff8c00; font-size: 150%;">(</span><span style="color: #ff1493; font-size: 140%;">(</span>s1, s2<span style="color: #ff1493; font-size: 140%;">)</span> -&gt; s1.compareToIgnoreCase<span style="color: #ff1493; font-size: 140%;">(</span>s2<span style="color: #ff1493; font-size: 140%;">)</span><span style="color: #ff8c00; font-size: 150%;">)</span>; <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">=&gt;</span>
str.sort<span style="color: #ff8c00; font-size: 150%;">(</span>String::compareToIgnoreCase<span style="color: #ff8c00; font-size: 150%;">)</span>;

<span style="color: #5fafff;">Function</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">String</span>, <span style="color: #5fafff;">Integer</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">stringToInteger</span> =
    <span style="color: #ff8c00; font-size: 150%;">(</span>String <span style="color: #5fafff;">s</span><span style="color: #ff8c00; font-size: 150%;">)</span> -&gt; Integer.parseInt<span style="color: #ff8c00; font-size: 150%;">(</span>s<span style="color: #ff8c00; font-size: 150%;">)</span>; <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">=&gt;</span>
<span style="color: #5fafff;">Function</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">String</span>, <span style="color: #5fafff;">Integer</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">stringToInteger</span> = Integer::parseInt;

<span style="color: #5fafff;">BiPredicate</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">List</span><span style="color: #ff1493; font-size: 140%;">&lt;</span><span style="color: #5fafff;">String</span><span style="color: #ff1493; font-size: 140%;">&gt;</span>, <span style="color: #5fafff;">String</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">contains</span> =
    <span style="color: #ff8c00; font-size: 150%;">(</span>list, element<span style="color: #ff8c00; font-size: 150%;">)</span> -&gt; list.contains<span style="color: #ff8c00; font-size: 150%;">(</span>element<span style="color: #ff8c00; font-size: 150%;">)</span>; <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">=&gt;</span>
<span style="color: #5fafff;">BiPredicate</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">List</span><span style="color: #ff1493; font-size: 140%;">&lt;</span><span style="color: #5fafff;">String</span><span style="color: #ff1493; font-size: 140%;">&gt;</span>, <span style="color: #5fafff;">String</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">contains</span> = List::contains;
</pre>
</div>
</div>
</div>

<div id="outline-container-org8bb548f" class="outline-4">
<h4 id="org8bb548f"><span class="section-number-4">3.2.2</span> 构造方法引用</h4>
<div class="outline-text-4" id="text-3-2-2">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #5fafff;">Supplier</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">a</span> = <span style="color: #ff8c00; font-size: 150%;">()</span> -&gt; <span style="color: #d787d7; font-weight: bold;">new</span> <span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">()</span>; <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">=&gt;</span>
<span style="color: #5fafff;">Supplier</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">a</span> = Apple::<span style="color: #d787d7; font-weight: bold;">new</span>;

<span style="color: #5fafff;">Function</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Integer</span>,<span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">a</span> = <span style="color: #ff8c00; font-size: 150%;">(</span>weight<span style="color: #ff8c00; font-size: 150%;">)</span> -&gt; <span style="color: #d787d7; font-weight: bold;">new</span> <span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">(</span>weight<span style="color: #ff8c00; font-size: 150%;">)</span>; <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">=&gt;</span>
<span style="color: #5fafff;">Function</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Integer</span>,<span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">a</span> = Apple::<span style="color: #d787d7; font-weight: bold;">new</span>;

<span style="color: #5fafff;">BiFunction</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">String</span>, <span style="color: #5fafff;">Integer</span>, <span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">c3</span> =
    <span style="color: #ff8c00; font-size: 150%;">(</span>color, weight<span style="color: #ff8c00; font-size: 150%;">)</span> -&gt; <span style="color: #d787d7; font-weight: bold;">new</span> <span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">(</span>color, weight<span style="color: #ff8c00; font-size: 150%;">)</span>; <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">=&gt;</span>
<span style="color: #5fafff;">BiFunction</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">String</span>, <span style="color: #5fafff;">Integer</span>, <span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">c3</span> = Apple::<span style="color: #d787d7; font-weight: bold;">new</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaaff1b4" class="outline-4">
<h4 id="orgaaff1b4"><span class="section-number-4">3.2.3</span> 排序</h4>
<div class="outline-text-4" id="text-3-2-3">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">Comparator &#20855;&#26377;&#19968;&#20010;&#21483;&#20316; comparing &#30340;&#38745;&#24577;&#36741;&#21161;&#26041;&#27861;&#65292;</span>
<span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">&#23427;&#21487;&#20197;&#25509;&#21463;&#19968;&#20010; Function &#26469;&#25552;&#21462; Comparable &#38190;&#20540;&#65292;&#24182;&#29983;&#25104;&#19968;&#20010; Comparator &#23545;&#35937;</span>
<span style="color: #d787d7; font-weight: bold;">import</span> <span style="color: #d787d7; font-weight: bold;">static</span> <span style="color: #d7875f; font-weight: bold;">java</span>.<span style="color: #d7875f; font-weight: bold;">util</span>.Comparator.<span style="color: #5fafff;">comparing</span>;
inventories.sort<span style="color: #ff8c00; font-size: 150%;">(</span>comparing<span style="color: #ff1493; font-size: 140%;">(</span><span style="color: #7fff00; font-size: 130%;">(</span>a<span style="color: #7fff00; font-size: 130%;">)</span> -&gt; a.getWeight<span style="color: #7fff00; font-size: 130%;">()</span><span style="color: #ff1493; font-size: 140%;">)</span><span style="color: #ff8c00; font-size: 150%;">)</span>;
inventories.sort<span style="color: #ff8c00; font-size: 150%;">(</span>comparing<span style="color: #ff1493; font-size: 140%;">(</span>Apple::getWeight<span style="color: #ff1493; font-size: 140%;">)</span><span style="color: #ff8c00; font-size: 150%;">)</span>;

inventories.sort<span style="color: #ff8c00; font-size: 150%;">(</span>comparing<span style="color: #ff1493; font-size: 140%;">(</span>Apple::getWeight<span style="color: #ff1493; font-size: 140%;">)</span>.reversed<span style="color: #ff1493; font-size: 140%;">()</span><span style="color: #ff8c00; font-size: 150%;">)</span>; <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">&#36870;&#24207;</span>

inventories.sort<span style="color: #ff8c00; font-size: 150%;">(</span>comparing<span style="color: #ff1493; font-size: 140%;">(</span>Apple::getWeight<span style="color: #ff1493; font-size: 140%;">)</span>.thenComparing<span style="color: #ff1493; font-size: 140%;">(</span>Apple::getColour<span style="color: #ff1493; font-size: 140%;">)</span><span style="color: #ff8c00; font-size: 150%;">)</span>; <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">&#27604;&#36739;&#22120;&#38142;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org99aa17c" class="outline-4">
<h4 id="org99aa17c"><span class="section-number-4">3.2.4</span> 谓词复合 (negate, and, or)</h4>
<div class="outline-text-4" id="text-3-2-4">
<p>
and 和 or 方法是按照在表达式链中的位置，从左向右确定优先级的。
</p>

<p>
<code>a.or(b).and(c)</code> 可以看作 <code>(a || b) &amp;&amp; c</code>
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #5fafff;">Predicate</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">notRedApple</span> = redApple.negate<span style="color: #ff8c00; font-size: 150%;">()</span>;

<span style="color: #5fafff;">Predicate</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">redAndHeavyApple</span> =
    redApple.and<span style="color: #ff8c00; font-size: 150%;">(</span>a -&gt; a.getWeight<span style="color: #ff1493; font-size: 140%;">()</span> &gt; 150<span style="color: #ff8c00; font-size: 150%;">)</span>;

<span style="color: #5fafff;">Predicate</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Apple</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">redAndHeavyAppleOrGreen</span> =
    redApple.and<span style="color: #ff8c00; font-size: 150%;">(</span>a -&gt; a.getWeight<span style="color: #ff1493; font-size: 140%;">()</span> &gt; 150<span style="color: #ff8c00; font-size: 150%;">)</span>
    .or<span style="color: #ff8c00; font-size: 150%;">(</span>a -&gt; <span style="color: #87af5f;">"green"</span>.equals<span style="color: #ff1493; font-size: 140%;">(</span>a.getColor<span style="color: #7fff00; font-size: 130%;">()</span><span style="color: #ff1493; font-size: 140%;">)</span><span style="color: #ff8c00; font-size: 150%;">)</span>;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaf88267" class="outline-4">
<h4 id="orgaf88267"><span class="section-number-4">3.2.5</span> 函数复合</h4>
<div class="outline-text-4" id="text-3-2-5">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">andThen: g(f(x))</span>
<span style="color: #5fafff;">Function</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Integer</span>, <span style="color: #5fafff;">Integer</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">f</span> = x -&gt; x + 1;
<span style="color: #5fafff;">Function</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Integer</span>, <span style="color: #5fafff;">Integer</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">g</span> = x -&gt; x * 2;
<span style="color: #5fafff;">Function</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Integer</span>, <span style="color: #5fafff;">Integer</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">h</span> = f.andThen<span style="color: #ff8c00; font-size: 150%;">(</span>g<span style="color: #ff8c00; font-size: 150%;">)</span>;
<span style="color: #5fafff;">int</span> <span style="color: #5fafff;">result</span> = h.apply<span style="color: #ff8c00; font-size: 150%;">(</span>1<span style="color: #ff8c00; font-size: 150%;">)</span>; <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">4</span>

<span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">compose: f(g(x))</span>
<span style="color: #5fafff;">Function</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Integer</span>, <span style="color: #5fafff;">Integer</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">f</span> = x -&gt; x + 1;
<span style="color: #5fafff;">Function</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Integer</span>, <span style="color: #5fafff;">Integer</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">g</span> = x -&gt; x * 2;
<span style="color: #5fafff;">Function</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Integer</span>, <span style="color: #5fafff;">Integer</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">h</span> = f.compose<span style="color: #ff8c00; font-size: 150%;">(</span>g<span style="color: #ff8c00; font-size: 150%;">)</span>;
<span style="color: #5fafff;">int</span> <span style="color: #5fafff;">result</span> = h.apply<span style="color: #ff8c00; font-size: 150%;">(</span>1<span style="color: #ff8c00; font-size: 150%;">)</span>; <span style="color: #707070; font-style: italic;">// </span><span style="color: #707070; font-style: italic;">3</span>
</pre>
</div>
</div>
</div>
</div>
</div>



<div id="outline-container-org39c72bf" class="outline-2">
<h2 id="org39c72bf"><span class="section-number-2">4</span> Optional</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orgb9a962a" class="outline-3">
<h3 id="orgb9a962a"><span class="section-number-3">4.1</span> 基本原理</h3>
<div class="outline-text-3" id="text-4-1">
<p>
不推荐使用基础类型的 Optional ，因为基础类型的 Optional 不支持map，flatMap 以及 filter 方法，
而这些却是 Optional 类最有用的方法。
</p>
</div>
</div>


<div id="outline-container-orgb99e621" class="outline-3">
<h3 id="orgb99e621"><span class="section-number-3">4.2</span> 代码示例</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-org2d0b059" class="outline-4">
<h4 id="org2d0b059"><span class="section-number-4">4.2.1</span> 类三元操作符</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
以不解包的方式组合两个 Optional 对象，用一行语句实现条件判断的结构：
</p>

<div class="org-src-container">
<pre class="src src-java"><span style="color: #d787d7; font-weight: bold;">public</span> <span style="color: #5fafff;">Optional</span><span style="color: #ff8c00; font-size: 150%;">&lt;</span><span style="color: #5fafff;">Insurance</span><span style="color: #ff8c00; font-size: 150%;">&gt;</span> <span style="color: #5fafff;">nullSafeFindCheapestInsurance</span><span style="color: #ff8c00; font-size: 150%;">(</span><span style="color: #5fafff;">Optional</span><span style="color: #ff1493; font-size: 140%;">&lt;</span><span style="color: #5fafff;">Person</span><span style="color: #ff1493; font-size: 140%;">&gt;</span> <span style="color: #5fafff;">person</span>, <span style="color: #5fafff;">Optional</span><span style="color: #ff1493; font-size: 140%;">&lt;</span><span style="color: #5fafff;">Car</span><span style="color: #ff1493; font-size: 140%;">&gt;</span> <span style="color: #5fafff;">car</span><span style="color: #ff8c00; font-size: 150%;">)</span> <span style="color: #ff8c00; font-size: 150%;">{</span>
    <span style="color: #d787d7; font-weight: bold;">return</span> person.flatMap<span style="color: #ff1493; font-size: 140%;">(</span>p -&gt; car.map<span style="color: #7fff00; font-size: 130%;">(</span>c -&gt; findCheapestInsurance<span style="color: #00bfff; font-size: 120%;">(</span>p, c<span style="color: #00bfff; font-size: 120%;">)</span><span style="color: #7fff00; font-size: 130%;">)</span><span style="color: #ff1493; font-size: 140%;">)</span>;
<span style="color: #ff8c00; font-size: 150%;">}</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-org7f2dbf0" class="outline-4">
<h4 id="org7f2dbf0"><span class="section-number-4">4.2.2</span> 避免在 Null 对象上调用 stream()</h4>
<div class="outline-text-4" id="text-4-2-2">
<div class="org-src-container">
<pre class="src src-java"><span style="color: #d7875f; font-weight: bold;">org</span>.<span style="color: #d7875f; font-weight: bold;">apache</span>.<span style="color: #d7875f; font-weight: bold;">commons</span>.<span style="color: #d7875f; font-weight: bold;">collections4</span>.CollectionUtils.emptyIfNull<span style="color: #ff8c00; font-size: 150%;">(</span><span style="color: #5fafff;">list</span><span style="color: #ff8c00; font-size: 150%;">)</span>
    .stream<span style="color: #ff8c00; font-size: 150%;">()</span>
    .filter<span style="color: #ff8c00; font-size: 150%;">(</span>...<span style="color: #ff8c00; font-size: 150%;">)</span>;
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</body>
</html>