#+TITLE:     Spring Boot
#+AUTHOR:    Hao Ruan
#+EMAIL:     ruanhao1116@gmail.com
#+LANGUAGE:  en
#+LINK_HOME: http://www.github.com/ruanhao
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="../css/style.css" />
#+OPTIONS:   H:2 num:nil \n:nil @:t ::t |:t ^:{} _:{} *:t TeX:t LaTeX:t
#+STARTUP:   showall


* 常用代码段

** Controller

- 获取 url query

  #+BEGIN_SRC java
    import org.springframework.web.util.UriUtils;
    import javax.servlet.http.HttpServletRequest;
    import java.io.UnsupportedEncodingException;
    import com.google.common.base.Charsets;

    public void foo(HttpServletRequest request) throws UnsupportedEncodingException {
        String query = UriUtils.decode(request.getQueryString(), Charsets.UTF_8.name());
    }
  #+END_SRC

- 下载

  #+BEGIN_SRC java
    import java.io.File;
    import java.io.FileInputStream;
    import java.io.InputStream;
    import lombok.Cleanup;
    import javax.servlet.http.HttpServletResponse;

    @GetMapping(path="/restful", produces="application/zip")
    public void download(HttpServletResponse response) throws Exception {
        File file = new File("/path/to/file");
        response.setHeader("Content-disposition", "attachment; filename="+tarFile.getName());
        @Cleanup InputStream is = new FileInputStream(file);
        org.apache.commons.io.IOUtils.copy(is, response.getOutputStream());
        response.flushBuffer();
    }
  #+END_SRC