<!DOCTYPE html>
<html>
<head>
<title>Bash</title>
<!-- 2018-02-05 Mon 15:49 -->
<meta  charset="utf-8">
<meta  name="generator" content="Org-mode">
<meta  name="author" content="Hao Ruan">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link href="http://fonts.googleapis.com/css?family=Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet" type="text/css" />
<link href="../org-html-themes/css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Bash</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. 循环</a>
<ul>
<li><a href="#sec-1-1">1.1. for</a>
<ul>
<li><a href="#sec-1-1-1">1.1.1. 基本用法</a></li>
<li><a href="#sec-1-1-2">1.1.2. bash 风格</a></li>
<li><a href="#sec-1-1-3">1.1.3. c 风格</a></li>
</ul>
</li>
<li><a href="#sec-1-2">1.2. while</a>
<ul>
<li><a href="#sec-1-2-1">1.2.1. 基本用法</a></li>
<li><a href="#sec-1-2-2">1.2.2. c 风格</a></li>
</ul>
</li>
<li><a href="#sec-1-3">1.3. IFS</a></li>
<li><a href="#sec-1-4">1.4. continue, break</a></li>
<li><a href="#sec-1-5">1.5. case, select</a></li>
<li><a href="#sec-1-6">1.6. 带步进值的循环</a></li>
</ul>
</li>
<li><a href="#sec-2">2. 函数</a>
<ul>
<li><a href="#sec-2-1">2.1. 在 <code>if/then</code> 结构中定义函数</a></li>
<li><a href="#sec-2-2">2.2. 函数指针</a></li>
</ul>
</li>
<li><a href="#sec-3">3. 声明</a>
<ul>
<li><a href="#sec-3-1">3.1. 声明只读变量</a></li>
<li><a href="#sec-3-2">3.2. 查看变量类型</a></li>
<li><a href="#sec-3-3">3.3. 声明整形变量</a></li>
<li><a href="#sec-3-4">3.4. 声明数组变量</a></li>
<li><a href="#sec-3-5">3.5. 声明函数指针</a></li>
<li><a href="#sec-3-6">3.6. 限制变量作用域</a></li>
</ul>
</li>
<li><a href="#sec-4">4. 测试</a>
<ul>
<li><a href="#sec-4-1">4.1. 测试文件类型</a></li>
<li><a href="#sec-4-2">4.2. 测试文件权限</a></li>
<li><a href="#sec-4-3">4.3. 文件比较</a></li>
<li><a href="#sec-4-4">4.4. <b>整数</b> 比较</a></li>
<li><a href="#sec-4-5">4.5. 字符串比较</a></li>
<li><a href="#sec-4-6">4.6. 多重条件判定</a></li>
<li><a href="#sec-4-7">4.7. 双括号和单括号中的行为比较</a></li>
<li><a href="#sec-4-8">4.8. c 风格</a></li>
</ul>
</li>
<li><a href="#sec-5">5. 变量</a>
<ul>
<li><a href="#sec-5-1">5.1. 变量检查</a></li>
<li><a href="#sec-5-2">5.2. 变量匹配</a></li>
<li><a href="#sec-5-3">5.3. 变量替换</a></li>
<li><a href="#sec-5-4">5.4. 变量赋值</a>
<ul>
<li><a href="#sec-5-4-1">5.4.1. 文件内容赋值</a></li>
<li><a href="#sec-5-4-2">5.4.2. 间接引用</a></li>
</ul>
</li>
<li><a href="#sec-5-5">5.5. 数组变量</a>
<ul>
<li><a href="#sec-5-5-1">5.5.1. 访问</a></li>
<li><a href="#sec-5-5-2">5.5.2. 赋值</a></li>
<li><a href="#sec-5-5-3">5.5.3. 删除</a></li>
<li><a href="#sec-5-5-4">5.5.4. 扩展</a></li>
<li><a href="#sec-5-5-5">5.5.5. 元素个数</a></li>
<li><a href="#sec-5-5-6">5.5.6. Bash 允许把变量当成数组来操作，即使这个变量没有明确地被声明为数组</a></li>
<li><a href="#sec-5-5-7">5.5.7. 对字符串使用数组操作</a></li>
</ul>
</li>
<li><a href="#sec-5-6">5.6. 特殊变量</a></li>
</ul>
</li>
<li><a href="#sec-6">6. 字符串处理</a>
<ul>
<li><a href="#sec-6-1">6.1. 获取字符串变量长度</a></li>
<li><a href="#sec-6-2">6.2. 子串匹配</a>
<ul>
<li><a href="#sec-6-2-1">6.2.1. <b>匹配字符串开头</b> 的子串长度</a></li>
<li><a href="#sec-6-2-2">6.2.2. 匹配字符串中子串第一次出现的位置</a></li>
</ul>
</li>
<li><a href="#sec-6-3">6.3. 子串提取</a>
<ul>
<li><a href="#sec-6-3-1">6.3.1. 正向提取子串</a></li>
<li><a href="#sec-6-3-2">6.3.2. 反向（从右边开始）提取子串</a></li>
<li><a href="#sec-6-3-3">6.3.3. 从 <b>开始位置</b> 提取 substring (substring 是正则表达式)</a></li>
<li><a href="#sec-6-3-4">6.3.4. 从 <b>结尾</b> 提取 substring (substring 是正则表达式)</a></li>
</ul>
</li>
<li><a href="#sec-6-4">6.4. 子串消除</a></li>
<li><a href="#sec-6-5">6.5. 子串替换</a></li>
<li><a href="#sec-6-6">6.6. 大小写转换</a></li>
</ul>
</li>
<li><a href="#sec-7">7. 参数处理</a>
<ul>
<li><a href="#sec-7-1">7.1. 获取最后一个参数</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="meta">
<table>


<colgroup>
<col  class="left">

<col  class="left">
</colgroup>
<tbody>
<tr>
<td class="left">Author</td>
<td class="left">Hao Ruan (haoru@cisco.com)</td>
</tr>

<tr>
<td class="left">Date</td>
<td class="left">2018-02-05 15:49:24</td>
</tr>
</tbody>
</table>
</div>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. 循环</a>
<ul>
<li><a href="#sec-1-1">1.1. for</a>
<ul>
<li><a href="#sec-1-1-1">1.1.1. 基本用法</a></li>
<li><a href="#sec-1-1-2">1.1.2. bash 风格</a></li>
<li><a href="#sec-1-1-3">1.1.3. c 风格</a></li>
</ul>
</li>
<li><a href="#sec-1-2">1.2. while</a>
<ul>
<li><a href="#sec-1-2-1">1.2.1. 基本用法</a></li>
<li><a href="#sec-1-2-2">1.2.2. c 风格</a></li>
</ul>
</li>
<li><a href="#sec-1-3">1.3. IFS</a></li>
<li><a href="#sec-1-4">1.4. continue, break</a></li>
<li><a href="#sec-1-5">1.5. case, select</a></li>
<li><a href="#sec-1-6">1.6. 带步进值的循环</a></li>
</ul>
</li>
<li><a href="#sec-2">2. 函数</a>
<ul>
<li><a href="#sec-2-1">2.1. 在 <code>if/then</code> 结构中定义函数</a></li>
<li><a href="#sec-2-2">2.2. 函数指针</a></li>
</ul>
</li>
<li><a href="#sec-3">3. 声明</a>
<ul>
<li><a href="#sec-3-1">3.1. 声明只读变量</a></li>
<li><a href="#sec-3-2">3.2. 查看变量类型</a></li>
<li><a href="#sec-3-3">3.3. 声明整形变量</a></li>
<li><a href="#sec-3-4">3.4. 声明数组变量</a></li>
<li><a href="#sec-3-5">3.5. 声明函数指针</a></li>
<li><a href="#sec-3-6">3.6. 限制变量作用域</a></li>
</ul>
</li>
<li><a href="#sec-4">4. 测试</a>
<ul>
<li><a href="#sec-4-1">4.1. 测试文件类型</a></li>
<li><a href="#sec-4-2">4.2. 测试文件权限</a></li>
<li><a href="#sec-4-3">4.3. 文件比较</a></li>
<li><a href="#sec-4-4">4.4. <b>整数</b> 比较</a></li>
<li><a href="#sec-4-5">4.5. 字符串比较</a></li>
<li><a href="#sec-4-6">4.6. 多重条件判定</a></li>
<li><a href="#sec-4-7">4.7. 双括号和单括号中的行为比较</a></li>
<li><a href="#sec-4-8">4.8. c 风格</a></li>
</ul>
</li>
<li><a href="#sec-5">5. 变量</a>
<ul>
<li><a href="#sec-5-1">5.1. 变量检查</a></li>
<li><a href="#sec-5-2">5.2. 变量匹配</a></li>
<li><a href="#sec-5-3">5.3. 变量替换</a></li>
<li><a href="#sec-5-4">5.4. 变量赋值</a>
<ul>
<li><a href="#sec-5-4-1">5.4.1. 文件内容赋值</a></li>
<li><a href="#sec-5-4-2">5.4.2. 间接引用</a></li>
</ul>
</li>
<li><a href="#sec-5-5">5.5. 数组变量</a>
<ul>
<li><a href="#sec-5-5-1">5.5.1. 访问</a></li>
<li><a href="#sec-5-5-2">5.5.2. 赋值</a></li>
<li><a href="#sec-5-5-3">5.5.3. 删除</a></li>
<li><a href="#sec-5-5-4">5.5.4. 扩展</a></li>
<li><a href="#sec-5-5-5">5.5.5. 元素个数</a></li>
<li><a href="#sec-5-5-6">5.5.6. Bash 允许把变量当成数组来操作，即使这个变量没有明确地被声明为数组</a></li>
<li><a href="#sec-5-5-7">5.5.7. 对字符串使用数组操作</a></li>
</ul>
</li>
<li><a href="#sec-5-6">5.6. 特殊变量</a></li>
</ul>
</li>
<li><a href="#sec-6">6. 字符串处理</a>
<ul>
<li><a href="#sec-6-1">6.1. 获取字符串变量长度</a></li>
<li><a href="#sec-6-2">6.2. 子串匹配</a>
<ul>
<li><a href="#sec-6-2-1">6.2.1. <b>匹配字符串开头</b> 的子串长度</a></li>
<li><a href="#sec-6-2-2">6.2.2. 匹配字符串中子串第一次出现的位置</a></li>
</ul>
</li>
<li><a href="#sec-6-3">6.3. 子串提取</a>
<ul>
<li><a href="#sec-6-3-1">6.3.1. 正向提取子串</a></li>
<li><a href="#sec-6-3-2">6.3.2. 反向（从右边开始）提取子串</a></li>
<li><a href="#sec-6-3-3">6.3.3. 从 <b>开始位置</b> 提取 substring (substring 是正则表达式)</a></li>
<li><a href="#sec-6-3-4">6.3.4. 从 <b>结尾</b> 提取 substring (substring 是正则表达式)</a></li>
</ul>
</li>
<li><a href="#sec-6-4">6.4. 子串消除</a></li>
<li><a href="#sec-6-5">6.5. 子串替换</a></li>
<li><a href="#sec-6-6">6.6. 大小写转换</a></li>
</ul>
</li>
<li><a href="#sec-7">7. 参数处理</a>
<ul>
<li><a href="#sec-7-1">7.1. 获取最后一个参数</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> 循环</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> for</h3>
<div class="outline-text-3" id="text-1-1">
</div><div id="outline-container-sec-1-1-1" class="outline-4">
<h4 id="sec-1-1-1"><span class="section-number-4">1.1.1</span> 基本用法</h4>
<div class="outline-text-4" id="text-1-1-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5f8700;">for</span> arg; <span style="color: #5f8700;">do</span>
    <span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">TODO</span>
<span style="color: #5f8700;">done</span> [ | <span style="color: #5f8700;">command</span> ]
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-2" class="outline-4">
<h4 id="sec-1-1-2"><span class="section-number-4">1.1.2</span> bash 风格</h4>
<div class="outline-text-4" id="text-1-1-2">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5f8700;">for</span> i<span style="color: #5f8700;"> in</span> {1..10}; <span style="color: #5f8700;">do</span>
    <span style="color: #5f8700;">echo</span> -n <span style="color: #00afaf;">"$i "</span>
<span style="color: #5f8700;">done</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-1-3" class="outline-4">
<h4 id="sec-1-1-3"><span class="section-number-4">1.1.3</span> c 风格</h4>
<div class="outline-text-4" id="text-1-1-3">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">LIMIT</span>=10

<span style="color: #5f8700;">for</span> ((i = 1; i &lt;= LIMIT; i++)); <span style="color: #5f8700;">do</span>
    <span style="color: #5f8700;">echo</span> -n <span style="color: #00afaf;">"$i "</span>
<span style="color: #5f8700;">done</span>
</pre>
</div>

<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">LIMIT</span>=10

<span style="color: #5f8700;">for</span> ((i = 1, j = 1; i &lt;= LIMIT; i++, j++)); <span style="color: #5f8700;">do</span>
    <span style="color: #5f8700;">echo</span> -n <span style="color: #00afaf;">"$i-$j "</span>
<span style="color: #5f8700;">done</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> while</h3>
<div class="outline-text-3" id="text-1-2">
</div><div id="outline-container-sec-1-2-1" class="outline-4">
<h4 id="sec-1-2-1"><span class="section-number-4">1.2.1</span> 基本用法</h4>
<div class="outline-text-4" id="text-1-2-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5f8700;">while </span><span style="color: #5f8700;">read</span> line; <span style="color: #5f8700;">do</span>
    <span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">TODO</span>
<span style="color: #5f8700;">done</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-2-2" class="outline-4">
<h4 id="sec-1-2-2"><span class="section-number-4">1.2.2</span> c 风格</h4>
<div class="outline-text-4" id="text-1-2-2">
<div class="org-src-container">

<pre class="src src-sh">(( i = 1 ))

<span style="color: #5f8700;">while</span> (( i &lt;= LIMIT )); <span style="color: #5f8700;">do</span>
    <span style="color: #5f8700;">echo</span> -n <span style="color: #00afaf;">"$i "</span>
    (( i += 1 ))
<span style="color: #5f8700;">done</span>
</pre>
</div>
</div>
</div>
</div>




<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> IFS</h3>
<div class="outline-text-3" id="text-1-3">
<p>
可以在循环内部设置 <code>$IFS</code> 变量，而不用把原始的 <code>$IFS</code> 保存到临时变量中
</p>

<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5f8700;">echo</span> <span style="color: #00afaf;">"List of all users:"</span>
<span style="color: #5f8700;">while</span> <span style="color: #0087ff;">IFS</span>=: read name passwd uid gid fullname ignore; <span style="color: #5f8700;">do</span>
    <span style="color: #5f8700;">echo</span> <span style="color: #00afaf;">"$name ($fullname)"</span>
<span style="color: #5f8700;">done</span> &lt;/etc/passwd
<span style="color: #5f8700;">echo</span> <span style="color: #00afaf;">"\$IFS still $IFS"</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> continue, break</h3>
<div class="outline-text-3" id="text-1-4">
<p>
<code>continue</code> 命令可以 <b>带一个参数</b> ，不带参数的 <code>continue</code> 命令只会去掉本次循环的剩余代码，而 <code>continue N</code> 将会把 N 层循环的剩余代码都去掉。
</p>

<p>
<code>break</code> 命令 <b>可以带一个参数</b> ，一个不带参数的 <code>break</code> 命令只能退出最内层的循环，而 <code>break N</code> 可以退出 N 层循环。
</p>
</div>
</div>


<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> case, select</h3>
<div class="outline-text-3" id="text-1-5">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">Bash Menu Script Example</span>

<span style="color: #0087ff;">PS3</span>=<span style="color: #00afaf;">'Please enter your choice: '</span>
<span style="color: #0087ff;">options</span>=(<span style="color: #00afaf;">"Option 1"</span> <span style="color: #00afaf;">"Option 2"</span> <span style="color: #00afaf;">"Option 3"</span> <span style="color: #00afaf;">"Quit"</span>)
<span style="color: #5f8700;">select</span> opt<span style="color: #5f8700;"> in</span> <span style="color: #00afaf;">"${options[@]}"</span>
<span style="color: #5f8700;">do</span>
    <span style="color: #5f8700;">case</span> $<span style="color: #0087ff;">opt</span><span style="color: #5f8700;"> in</span>
        <span style="color: #00afaf;">"Option 1"</span>)
            <span style="color: #5f8700;">echo</span> <span style="color: #00afaf;">"you chose choice 1"</span>
            ;;
        <span style="color: #00afaf;">"Option 2"</span>)
            <span style="color: #5f8700;">echo</span> <span style="color: #00afaf;">"you chose choice 2"</span>
            ;;
        <span style="color: #00afaf;">"Option 3"</span>)
            <span style="color: #5f8700;">echo</span> <span style="color: #00afaf;">"you chose choice 3"</span>
            ;;
        <span style="color: #00afaf;">"Quit"</span>)
            <span style="color: #5f8700;">break</span> <span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">Add break statements wherever need the select loop to exit</span>
            ;;
        *) <span style="color: #5f8700;">echo</span> invalid option;;
    <span style="color: #5f8700;">esac</span>
<span style="color: #5f8700;">done</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="section-number-3">1.6</span> 带步进值的循环</h3>
<div class="outline-text-3" id="text-1-6">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5f8700;">for</span> i<span style="color: #5f8700;"> in</span> {0..100..3}; <span style="color: #5f8700;">do</span>
    <span style="color: #5f8700;">echo</span> $<span style="color: #0087ff;">i</span>
<span style="color: #5f8700;">done</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> 函数</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li><code>return</code> 只能用在函数或被 <code>source</code> 的脚本中
</li>
<li>函数如果在一行内定义，需要加分号： <code>hello() { true; }</code>
</li>
<li>代码块 <code>{}</code> ，又被称为内部组，实际上是创建了一个匿名函数，与标准函数不同的是，在其中申明的变量， <b>对脚本其他部分的代码而言是可见的</b>
</li>
</ul>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> 在 <code>if/then</code> 结构中定义函数</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5f8700;">if</span> [[ <span style="color: #00afaf;">"$USER"</span> == root ]]; <span style="color: #5f8700;">then</span>
    greet() {
        <span style="color: #5f8700;">echo</span> hello
    }
<span style="color: #5f8700;">fi</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> 函数指针</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5f8700;">declare</span> -f fp
<span style="color: #0087ff;">fp</span>=function_name
$<span style="color: #0087ff;">fp</span> arg1 arg2
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> 声明</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li><code>declare</code> 和 <code>typeset</code> 命令两者是 <b>完全一样</b> 的
</li>
</ul>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> 声明只读变量</h3>
<div class="outline-text-3" id="text-3-1">
<p>
<code>declare -r `Variable`</code> 等价于 <code>readonly `Variable`</code>
</p>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> 查看变量类型</h3>
<div class="outline-text-3" id="text-3-2">
<p>
<code>declare -p `Variable`</code>
</p>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> 声明整形变量</h3>
<div class="outline-text-3" id="text-3-3">
<p>
<code>declare -i `Variable`</code>
</p>

<p>
如果把一个变量指定为整形的话，即使没有 <code>expr</code> 或者 <code>let</code> 命令，也允许使用特定的算术运算
</p>
</div>
</div>

<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4"><span class="section-number-3">3.4</span> 声明数组变量</h3>
<div class="outline-text-3" id="text-3-4">
<p>
<code>declare -a `Array`</code>
</p>
</div>
</div>

<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5"><span class="section-number-3">3.5</span> 声明函数指针</h3>
<div class="outline-text-3" id="text-3-5">
<p>
<code>declare -f `[FunctionName]`</code>
</p>

<p>
如果不提供 FunctionName ，将会列出这个脚本之前定义的所有函数，若提供函数名，则给出这个函数的相关信息
</p>
</div>
</div>

<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6"><span class="section-number-3">3.6</span> 限制变量作用域</h3>
<div class="outline-text-3" id="text-3-6">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">foo</span>() {
    <span style="color: #5f8700;">declare</span> <span style="color: #0087ff;">FOO</span>=<span style="color: #00afaf;">"bar"</span>
}
<span style="color: #0087ff;">bar</span>() {
    foo
    <span style="color: #5f8700;">echo</span> $<span style="color: #0087ff;">FOO</span>
}
bar  <span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">output nothing</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> 测试</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> 测试文件类型</h3>
<div class="outline-text-3" id="text-4-1">
<dl class="org-dl">
<dt> <code>-e</code> </dt><dd>文件是否存在
</dd>
<dt> <code>-f</code> </dt><dd>文件是否存在且为文件（file）
</dd>
<dt> <code>-d</code> </dt><dd>文件是否存在且为目录（directory）
</dd>
<dt> <code>-b</code> </dt><dd>文件是否存在且为 block device
</dd>
<dt> <code>-c</code> </dt><dd>文件是否存在且为 character device
</dd>
<dt> <code>-S</code> </dt><dd>文件是否存在且为 Socket
</dd>
<dt> <code>-p</code> </dt><dd>文件是否存在且为 FIFO (pipe)
</dd>
<dt> <code>-L</code> </dt><dd>文件是否存在且为 link
</dd>
</dl>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> 测试文件权限</h3>
<div class="outline-text-3" id="text-4-2">
<dl class="org-dl">
<dt> <code>-r</code> </dt><dd>文件是否存在且具有可读权限
</dd>
<dt> <code>-w</code> </dt><dd>文件是否存在且具有可写权限
</dd>
<dt> <code>-x</code> </dt><dd>文件是否存在且具有可运行权限
</dd>
<dt> <code>-u</code> </dt><dd>文件是否存在且具有SUID权限
</dd>
<dt> <code>-g</code> </dt><dd>文件是否存在且具有SGID权限
</dd>
<dt> <code>-k</code> </dt><dd>文件是否存在且具有Sticky bit权限
</dd>
<dt> <code>-s</code> </dt><dd>文件是否存在且为非空白文件
</dd>
</dl>
</div>
</div>

<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> 文件比较</h3>
<div class="outline-text-3" id="text-4-3">
<dl class="org-dl">
<dt> <code>-nt</code> </dt><dd>判断 file1 是否比 file2 新
</dd>
<dt> <code>-ot</code> </dt><dd>判断 file1 是否比 file2 旧
</dd>
<dt> <code>-ef</code> </dt><dd>判断 file1 与 file2 是否为同一文件（两个文件是否均指向同一个 inode ）
</dd>
</dl>
</div>
</div>

<div id="outline-container-sec-4-4" class="outline-3">
<h3 id="sec-4-4"><span class="section-number-3">4.4</span> <b>整数</b> 比较</h3>
<div class="outline-text-3" id="text-4-4">
<dl class="org-dl">
<dt> <code>-eq</code> </dt><dd>equal
</dd>
<dt> <code>-ne</code> </dt><dd>not equal
</dd>
<dt> <code>-gt</code> </dt><dd>great than
</dd>
<dt> <code>-lt</code> </dt><dd>less than
</dd>
<dt> <code>-ge</code> </dt><dd>great than or equal
</dd>
<dt> <code>-le</code> </dt><dd>less than or equal
</dd>
</dl>
</div>
</div>


<div id="outline-container-sec-4-5" class="outline-3">
<h3 id="sec-4-5"><span class="section-number-3">4.5</span> 字符串比较</h3>
<div class="outline-text-3" id="text-4-5">
<dl class="org-dl">
<dt> <code>-z string</code> </dt><dd>若 string 为空字符串，则为 true  ( z 表示 zero )
</dd>
<dt> <code>-n string</code> </dt><dd>若 string 为空字符串，则为 false ( -n 可省略，n 表示 not empty )
</dd>
<dt> <code>str1 = str2</code> </dt><dd>若 str1 等于 str2 ，则为 true
</dd>
<dt> str1 != str2 </dt><dd>若 str1 等于 str2 ，则为 false
</dd>
</dl>
</div>
</div>


<div id="outline-container-sec-4-6" class="outline-3">
<h3 id="sec-4-6"><span class="section-number-3">4.6</span> 多重条件判定</h3>
<div class="outline-text-3" id="text-4-6">
<dl class="org-dl">
<dt> -a </dt><dd><code>test -r file -a -x file</code>
</dd>
<dt> -o </dt><dd><code>test -r file -o -x file</code>
</dd>
<dt> ! </dt><dd><code>test ! -x file</code>
</dd>
<dt> &amp;&amp; </dt><dd>用于双括号结构中
</dd>
<dt> || </dt><dd>用于双括号结构中
</dd>
</dl>
</div>
</div>


<div id="outline-container-sec-4-7" class="outline-3">
<h3 id="sec-4-7"><span class="section-number-3">4.7</span> 双括号和单括号中的行为比较</h3>
<div class="outline-text-3" id="text-4-7">
<div class="org-src-container">

<pre class="src src-sh">[[ $<span style="color: #0087ff;">var</span> == z* ]]   <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#22914;&#26524; var &#20197; z &#24320;&#22836;&#65292;&#21017;&#32467;&#26524;&#20026;&#30495;</span>

[ $<span style="color: #0087ff;">var</span> == z* ]     <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#22914;&#26524; var &#20026; zoo&#65292;&#24403;&#21069;&#30446;&#24405;&#19979;&#26377;&#19988;&#21482;&#26377;&#19968;&#20010;&#25991;&#20214;&#21517;&#20026; zoo&#65292;&#21017;&#32467;&#26524;&#20026;&#30495;&#65292;</span>
                   <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#27492;&#22788;&#65292;z* &#23558;&#25991;&#20214;&#21517;&#25193;&#23637;&#20102;</span>

[[ $<span style="color: #0087ff;">var</span> == <span style="color: #00afaf;">"z*"</span> ]] <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#22914;&#26524; var &#21644; "z*" &#22312;&#23383;&#38754;&#19978;&#23436;&#20840;&#30456;&#31561;&#65292;&#21017;&#32467;&#26524;&#20026;&#30495;</span>

[ $<span style="color: #0087ff;">var</span> == <span style="color: #00afaf;">"z*"</span> ]   <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#21516;&#19978;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4-8" class="outline-3">
<h3 id="sec-4-8"><span class="section-number-3">4.8</span> c 风格</h3>
<div class="outline-text-3" id="text-4-8">
<div class="org-src-container">

<pre class="src src-sh">(( a &lt; 16 )) &amp;&amp; <span style="color: #5f8700;">echo</span> <span style="color: #00afaf;">"true"</span>
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> 变量</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1"><span class="section-number-3">5.1</span> 变量检查</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">

<pre class="src src-sh">: ${<span style="color: #0087ff;">variable</span>?error_msg} <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#19968;&#31181;&#26816;&#26597;&#21464;&#37327;&#26159;&#21542;&#35774;&#32622;&#30340;&#26041;&#27861;&#65292;</span>
                        <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#33509;&#27809;&#26377;&#35774;&#32622;&#65292;&#21017;error_msg&#20250;&#36755;&#20986;&#21040;std_err&#20013;</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2"><span class="section-number-3">5.2</span> 变量匹配</h3>
<div class="outline-text-3" id="text-5-2">
<p>
<code>${!varprefix*}</code> 或 <code>${!varprefix@}</code> 用于匹配所有之前声明过的，并且以 <code>varprefix</code> 开头的变量
</p>

<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">xyz23</span>=whatever
<span style="color: #0087ff;">xyz24</span>=
<span style="color: #0087ff;">a</span>=${<span style="color: #0087ff;">!</span>xyz*}                     <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#23637;&#24320;&#25152;&#26377;&#20197;"xyz"&#24320;&#22836;&#30340;&#65292;&#24182;&#19988;&#20043;&#21069;&#22768;&#26126;&#36807;&#30340;&#21464;&#37327;&#21517;</span>
<span style="color: #5f8700;">echo</span> <span style="color: #00afaf;">"a = $a"</span>                  <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">a = xyz23 xyz24</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3"><span class="section-number-3">5.3</span> 变量替换</h3>
<div class="outline-text-3" id="text-5-3">
<table>


<colgroup>
<col  class="left">

<col  class="left">

<col  class="left">

<col  class="left">
</colgroup>
<thead>
<tr>
<th scope="col" class="left">str</th>
<th scope="col" class="left"><code>not set</code></th>
<th scope="col" class="left"><code>empty string</code></th>
<th scope="col" class="left"><code>set &amp; not empty string</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="left">var=${str-expr}</td>
<td class="left">var=expr</td>
<td class="left">var=""</td>
<td class="left">var=$str</td>
</tr>

<tr>
<td class="left">var=${str:-expr}</td>
<td class="left">var=expr</td>
<td class="left">var=expr</td>
<td class="left">var=$str</td>
</tr>

<tr>
<td class="left">var=${str+expr}</td>
<td class="left">var=""</td>
<td class="left">var=expr</td>
<td class="left">var=expr</td>
</tr>

<tr>
<td class="left">var=${str:+expr}</td>
<td class="left">var=""</td>
<td class="left">var=""</td>
<td class="left">var=expr</td>
</tr>

<tr>
<td class="left">var=${str=expr}</td>
<td class="left">str=expr; var=expr</td>
<td class="left">str <code>unchanged</code>; var=""</td>
<td class="left">str <code>unchanged</code>; var=$str</td>
</tr>

<tr>
<td class="left">var=${str:=expr}</td>
<td class="left">str=expr; var=expr</td>
<td class="left">str=expr; var=expr</td>
<td class="left">str <code>unchanged</code>; var=$str</td>
</tr>

<tr>
<td class="left">var=${str?expr}</td>
<td class="left">output expr to stderr</td>
<td class="left">var=""</td>
<td class="left">var=$str</td>
</tr>

<tr>
<td class="left">var=${str:?expr}</td>
<td class="left">output expr to stderr</td>
<td class="left">output expr to stderr</td>
<td class="left">var=$str</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4"><span class="section-number-3">5.4</span> 变量赋值</h3>
<div class="outline-text-3" id="text-5-4">
</div><div id="outline-container-sec-5-4-1" class="outline-4">
<h4 id="sec-5-4-1"><span class="section-number-4">5.4.1</span> 文件内容赋值</h4>
<div class="outline-text-4" id="text-5-4-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">var</span>=$( &lt;FileName )
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-4-2" class="outline-4">
<h4 id="sec-5-4-2"><span class="section-number-4">5.4.2</span> 间接引用</h4>
<div class="outline-text-4" id="text-5-4-2">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5f8700;">eval</span> <span style="color: #0087ff;">var1</span>=<span style="color: #00afaf;">\$</span><span style="color: #0087ff;">$var2</span>
</pre>
</div>

<p>
等效于：
</p>

<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">var1</span>=${<span style="color: #0087ff;">!</span>var2}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5"><span class="section-number-3">5.5</span> 数组变量</h3>
<div class="outline-text-3" id="text-5-5">
</div><div id="outline-container-sec-5-5-1" class="outline-4">
<h4 id="sec-5-5-1"><span class="section-number-4">5.5.1</span> 访问</h4>
<div class="outline-text-4" id="text-5-5-1">
<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #0087ff;">array</span>[Idx]}

<span style="color: #5f8700;">echo</span> ${<span style="color: #0087ff;">array</span>[*]} <span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">&#25171;&#21360;&#25152;&#26377;&#25968;&#32452;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-5-2" class="outline-4">
<h4 id="sec-5-5-2"><span class="section-number-4">5.5.2</span> 赋值</h4>
<div class="outline-text-4" id="text-5-5-2">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">arr</span>=( 1 2 3 4 5 )

<span style="color: #0087ff;">arr</span>=( [Idx1]=v1 [Idx2]=v2 )
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-5-3" class="outline-4">
<h4 id="sec-5-5-3"><span class="section-number-4">5.5.3</span> 删除</h4>
<div class="outline-text-4" id="text-5-5-3">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5f8700;">unset</span> array[2]      <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#21024;&#38500;&#25968;&#32452;&#31532;3&#20010;&#20803;&#32032;</span>
<span style="color: #5f8700;">unset</span> array         <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#21024;&#38500;&#25972;&#20010;&#25968;&#32452;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-5-4" class="outline-4">
<h4 id="sec-5-5-4"><span class="section-number-4">5.5.4</span> 扩展</h4>
<div class="outline-text-4" id="text-5-5-4">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">new_array</span>+=( 1 2 3 )
<span style="color: #0087ff;">new_array</span>=( <span style="color: #00afaf;">"${old_array[@]}"</span> new_element )
<span style="color: #0087ff;">array</span>[${#<span style="color: #0087ff;">array</span>[*]}]=new_element

<span style="color: #0087ff;">new_array</span>=<span style="color: #00afaf;">"${old_array[@]}"</span>  <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#22797;&#21046;&#25968;&#32452;(&#20294;&#26159;&#22914;&#26524;&#22312;*&#32570;&#39033;*&#25968;&#32452;&#20013;&#20351;&#29992;&#30340;&#35805;&#65292;&#23558;&#20250;&#22833;&#36133;&#65292;&#26032;&#25968;&#32452;&#20013;&#30340;&#26576;&#20010;&#20803;&#32032;&#20250;&#27809;&#34987;&#36171;&#20540;)</span>
                             <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#24314;&#35758;&#20351;&#29992; new=( ${old[*]} )</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-5-5-5" class="outline-4">
<h4 id="sec-5-5-5"><span class="section-number-4">5.5.5</span> 元素个数</h4>
<div class="outline-text-4" id="text-5-5-5">
<div class="org-src-container">

<pre class="src src-sh">${#<span style="color: #0087ff;">array</span>[*]}
${#<span style="color: #0087ff;">array</span>[@]}
</pre>
</div>

<p>
<b>注意</b> ：
</p>

<p>
<code>${#array}</code> ：表示数组中 <b>第一个元素的长度</b>
</p>
</div>
</div>

<div id="outline-container-sec-5-5-6" class="outline-4">
<h4 id="sec-5-5-6"><span class="section-number-4">5.5.6</span> Bash 允许把变量当成数组来操作，即使这个变量没有明确地被声明为数组</h4>
<div class="outline-text-4" id="text-5-5-6">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">string</span>=abcABC123ABCabc
<span style="color: #5f8700;">echo</span> ${<span style="color: #0087ff;">string</span>[@]}       <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">abcABC123ABCabc</span>
<span style="color: #5f8700;">echo</span> ${<span style="color: #0087ff;">string</span>[*]}       <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">abcABC123ABCabc</span>
<span style="color: #5f8700;">echo</span> ${<span style="color: #0087ff;">string</span>[0]}       <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">abcABC123ABCabc</span>
<span style="color: #5f8700;">echo</span> ${<span style="color: #0087ff;">string</span>[1]}       <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#27809;&#26377;&#36755;&#20986;</span>
<span style="color: #5f8700;">echo</span> ${#<span style="color: #0087ff;">string</span>[@]}      <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">1</span>
                        <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#25968;&#32452;&#20013;&#21482;&#26377;&#19968;&#20010;&#20803;&#32032;&#65292;&#23601;&#26159;&#36825;&#20010;&#23383;&#31526;&#20018;&#26412;&#36523;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-5-7" class="outline-4">
<h4 id="sec-5-5-7"><span class="section-number-4">5.5.7</span> 对字符串使用数组操作</h4>
<div class="outline-text-4" id="text-5-5-7">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">array</span>=( zero one two three four fiive )
${<span style="color: #0087ff;">array</span>[0]}         <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">zero</span>
${<span style="color: #0087ff;">array</span>}            <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#21516;&#19978;</span>
${<span style="color: #0087ff;">array</span>:1}          <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">ero</span>
$(<span style="color: #fa8072;">array</span>[0]:1}       <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#21516;&#19978;</span>
${#<span style="color: #0087ff;">array</span>[0]}        <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#31561;&#21516;&#20110; ${#array}</span>
${<span style="color: #0087ff;">array</span>[@]:0}       <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#25152;&#26377;&#20803;&#32032;</span>
${<span style="color: #0087ff;">array</span>[@]:1}       <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">element[0] &#21518;&#38754;&#30340;&#25152;&#26377;&#20803;&#32032;</span>
${<span style="color: #0087ff;">array</span>[@]:1:2}
${<span style="color: #0087ff;">array</span>[@]#f*r}
${<span style="color: #0087ff;">array</span>[@]%%t*e}
${<span style="color: #0087ff;">array</span>[@]/#fi/XY}
${<span style="color: #0087ff;">array</span>[@]/%ve/ZZ}  <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#36825;&#31867;&#25805;&#20316;&#20854;&#23454;&#37117;&#26159;&#23545;&#27599;&#20010; element &#20570;&#36718;&#35810;&#65292;</span>
                    <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#32780;&#19981;&#26159;&#38024;&#23545;&#25972;&#20010; array&#65292;</span>
                    <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#22914; ${array[*]#*ree}&#65292;&#21482;&#26159;&#21024;&#38500; three</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5-6" class="outline-3">
<h3 id="sec-5-6"><span class="section-number-3">5.6</span> 特殊变量</h3>
<div class="outline-text-3" id="text-5-6">
<div class="org-src-container">

<pre class="src src-sh">$<span style="color: #0087ff;">DIRSTACK</span> <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#20869;&#24314;&#25968;&#32452;&#65292;&#35760;&#24405;&#30446;&#24405;&#26632;</span>
$<span style="color: #0087ff;">#</span>        <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#21442;&#25968;&#25968;&#37327;</span>
$<span style="color: #0087ff;">$</span>        <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">shell&#36827;&#31243;ID</span>
$<span style="color: #0087ff;">-</span>        <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#24403;&#21069;shell&#30340;&#36873;&#39033;&#26631;&#35782;</span>
$<span style="color: #0087ff;">_</span>        <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#19978;&#19968;&#26465;&#21629;&#20196;&#30340;&#21442;&#25968;</span>
$<span style="color: #0087ff;">!</span>        <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#19978;&#19968;&#20010;&#22312;&#21518;&#21488;&#36816;&#34892;&#30340;&#20316;&#19994;&#30340;pid</span>
$<span style="color: #0087ff;">@</span>        <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">"$@" &#31561;&#20215;&#20110; "$1" "$2" "$3",</span>
          <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#25353;&#29031;&#31354;&#26684;&#26469;&#20998;&#38548;&#65292;&#23601;&#31639;IFS&#29992;&#21035;&#30340;&#23383;&#31526;&#65292;"$@"&#36824;&#26159;&#25353;&#29031;&#31354;&#26684;&#26469;&#21028;&#26029;&#21442;&#25968;&#30340;&#20010;&#25968;,</span>
          <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">$@ &#20063;&#21487;&#20197;&#29992;&#26469;&#33719;&#21462;&#20256;&#36882;&#32473;&#33050;&#26412;&#30340;&#36755;&#20837;&#65292;cat $@ &#21487;&#20197;&#25509;&#21463;&#20174; stdin &#20256;&#36882;&#32473;&#33050;&#26412;&#30340;&#36755;&#20837;&#65292;</span>
          <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#20063;&#21487;&#20197;&#25509;&#21463;&#20174;&#21442;&#25968;&#20013;&#25351;&#23450;&#30340;&#25991;&#20214;&#20013;&#20256;&#36882;&#32473;&#33050;&#26412;&#30340;&#36755;&#20837;,</span>
          <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">*$@ &#19982; $* &#20013;&#30340;&#21442;&#25968;&#21482;&#26377;&#22312;&#34987;&#21452;&#24341;&#21495;&#24341;&#29992;&#36215;&#26469;&#30340;&#26102;&#20505;&#25165;&#20250;&#19981;&#21516;</span>
${<span style="color: #0087ff;">#</span>*}     <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#20301;&#32622;&#21442;&#25968;&#30340;&#20010;&#25968;</span>
${#<span style="color: #0087ff;">@</span>}     <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#21516;&#19978;</span>
$<span style="color: #0087ff;">RANDOM</span>   <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">0 - 32767</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6"><span class="section-number-2">6</span> 字符串处理</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1"><span class="section-number-3">6.1</span> 获取字符串变量长度</h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">

<pre class="src src-sh">${#<span style="color: #0087ff;">var</span>}
expr <span style="color: #00afaf;">"$var"</span> : <span style="color: #00afaf;">'.*'</span>
expr length $<span style="color: #0087ff;">var</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2"><span class="section-number-3">6.2</span> 子串匹配</h3>
<div class="outline-text-3" id="text-6-2">
</div><div id="outline-container-sec-6-2-1" class="outline-4">
<h4 id="sec-6-2-1"><span class="section-number-4">6.2.1</span> <b>匹配字符串开头</b> 的子串长度</h4>
<div class="outline-text-4" id="text-6-2-1">
<div class="org-src-container">

<pre class="src src-sh">expr match <span style="color: #00afaf;">"$string"</span> <span style="color: #00afaf;">'$regex'</span>
expr <span style="color: #00afaf;">"$string"</span> : <span style="color: #00afaf;">'$regex'</span>
<span style="color: #0087ff;">stringZ</span>=abcABC123ABCabc
<span style="color: #5f8700;">echo</span> <span style="color: #fa8072;">`expr match "$stringZ" 'abc[A-Z]*.2'`</span>
<span style="color: #5f8700;">echo</span> <span style="color: #fa8072;">`expr "$stringZ" : 'abc[A-Z]*.2'`</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6-2-2" class="outline-4">
<h4 id="sec-6-2-2"><span class="section-number-4">6.2.2</span> 匹配字符串中子串第一次出现的位置</h4>
<div class="outline-text-4" id="text-6-2-2">
<div class="org-src-container">

<pre class="src src-sh">expr index $<span style="color: #0087ff;">string</span> $<span style="color: #0087ff;">regex</span>
<span style="color: #0087ff;">stringZ</span>=abcABC123ABCabc
<span style="color: #5f8700;">echo</span> <span style="color: #fa8072;">`expr index "$stringZ" C12`</span> <span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">6</span>
<span style="color: #5f8700;">echo</span> <span style="color: #fa8072;">`expr index "$stringZ" 1c`</span>  <span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">3, 'c' (in #3 position) matches before '1'</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3"><span class="section-number-3">6.3</span> 子串提取</h3>
<div class="outline-text-3" id="text-6-3">
</div><div id="outline-container-sec-6-3-1" class="outline-4">
<h4 id="sec-6-3-1"><span class="section-number-4">6.3.1</span> 正向提取子串</h4>
<div class="outline-text-4" id="text-6-3-1">
<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #0087ff;">string</span>:position}

${<span style="color: #0087ff;">string</span>:position:length}  <span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">&#22312; $string &#20013;&#20174;&#20301;&#32622; $position &#24320;&#22987;&#25552;&#21462;&#23376;&#20018;</span>
                           <span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">&#22914;&#26524; $string &#26159; * &#25110; @ &#65292;&#37027;&#20040;&#23558;&#20250;&#20174;&#20301;&#32622; $position &#24320;&#22987;&#25552;&#21462;&#20301;&#32622;&#21442;&#25968;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6-3-2" class="outline-4">
<h4 id="sec-6-3-2"><span class="section-number-4">6.3.2</span> 反向（从右边开始）提取子串</h4>
<div class="outline-text-4" id="text-6-3-2">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5f8700;">echo</span> ${<span style="color: #0087ff;">stringZ</span>:-4}   <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#38169;&#35823;&#35821;&#27861;&#65292;&#32467;&#26524;&#20026;&#25552;&#21462;&#20102;&#25972;&#20010;&#23383;&#31526;&#20018;</span>
<span style="color: #5f8700;">echo</span> ${<span style="color: #0087ff;">stringZ</span>:(-4)} <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#27491;&#30830;&#35821;&#27861;</span>
<span style="color: #5f8700;">echo</span> ${<span style="color: #0087ff;">stringZ</span>: -4}  <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#27491;&#30830;&#35821;&#27861;</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6-3-3" class="outline-4">
<h4 id="sec-6-3-3"><span class="section-number-4">6.3.3</span> 从 <b>开始位置</b> 提取 substring (substring 是正则表达式)</h4>
<div class="outline-text-4" id="text-6-3-3">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">stringZ</span>=abcABC123ABCabc

<span style="color: #5f8700;">echo</span> <span style="color: #fa8072;">`expr match "$stringZ" '\(.[b-c]*[A-Z]..[0-9]\)'`</span> <span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">abcABC1</span>
<span style="color: #5f8700;">echo</span> <span style="color: #fa8072;">`expr "$stringZ" : '\(.[b-c]*[A-Z]..[0-9]\)'`</span>
<span style="color: #5f8700;">echo</span> <span style="color: #fa8072;">`expr "$stringZ" : '\(.......\)'`</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6-3-4" class="outline-4">
<h4 id="sec-6-3-4"><span class="section-number-4">6.3.4</span> 从 <b>结尾</b> 提取 substring (substring 是正则表达式)</h4>
<div class="outline-text-4" id="text-6-3-4">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">stringZ</span>=abcABC123ABCabc

<span style="color: #5f8700;">echo</span> <span style="color: #fa8072;">`expr match "$stringZ" '.*\([A-C][A-C][A-C][a-c]*\)'`</span>
<span style="color: #5f8700;">echo</span> <span style="color: #fa8072;">`expr "$stringZ" : '.*\(......\)'`</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-6-4" class="outline-3">
<h3 id="sec-6-4"><span class="section-number-3">6.4</span> 子串消除</h3>
<div class="outline-text-3" id="text-6-4">
<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #0087ff;">string</span>#substring}  <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#20174;$string&#30340;**&#24320;&#22836;&#20301;&#32622;**&#25130;&#25481;&#26368;&#30701;&#21305;&#37197;&#30340;$substring</span>
${<span style="color: #0087ff;">string</span>##substring} <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#20174;$string&#30340;**&#24320;&#22836;&#20301;&#32622;**&#25130;&#25481;&#26368;&#38271;&#21305;&#37197;&#30340;$substring</span>
${<span style="color: #0087ff;">string</span>%substring}  <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#20174;$string&#30340;**&#32467;&#23614;&#20301;&#32622;**&#25130;&#25481;&#26368;&#30701;&#21305;&#37197;&#30340;$substring</span>
${<span style="color: #0087ff;">string</span>%%substring} <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#20174;$string&#30340;**&#32467;&#23614;&#20301;&#32622;**&#25130;&#25481;&#26368;&#38271;&#21305;&#37197;&#30340;$substring</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-6-5" class="outline-3">
<h3 id="sec-6-5"><span class="section-number-3">6.5</span> 子串替换</h3>
<div class="outline-text-3" id="text-6-5">
<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #0087ff;">string</span>/substring/replacement}  <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#20351;&#29992;$replacement&#26469;&#26367;&#25442;**&#31532;&#19968;&#20010;&#21305;&#37197;**&#30340;$substring</span>
${<span style="color: #0087ff;">string</span>//substring/replacement} <span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#20351;&#29992;$replacement&#26469;&#26367;&#25442;**&#25152;&#26377;&#21305;&#37197;**&#30340;$substring</span>
<span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#22914;&#26524;$substring&#21305;&#37197;$string&#30340;**&#24320;&#22836;&#37096;&#20998;**&#65292;&#37027;&#20040;&#23601;&#29992;$replacement&#26367;&#25442;$substring</span>
${<span style="color: #0087ff;">string</span>/#substring/replacement}
<span style="color: #585858; font-style: italic;">## </span><span style="color: #585858; font-style: italic;">&#22914;&#26524;$substring&#21305;&#37197;$string&#30340;**&#32467;&#23614;&#37096;&#20998;**&#65292;&#37027;&#20040;&#23601;&#29992;$replacement&#26367;&#25442;$substring</span>
${<span style="color: #0087ff;">string</span>/%substring/replacement}
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-6-6" class="outline-3">
<h3 id="sec-6-6"><span class="section-number-3">6.6</span> 大小写转换</h3>
<div class="outline-text-3" id="text-6-6">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #5f8700;">echo</span> ${<span style="color: #0087ff;">var</span>^^}
<span style="color: #5f8700;">echo</span> ${<span style="color: #0087ff;">var</span>,,}
tr <span style="color: #00afaf;">'[:lower:]'</span> <span style="color: #00afaf;">'[:upper:]'</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7"><span class="section-number-2">7</span> 参数处理</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1"><span class="section-number-3">7.1</span> 获取最后一个参数</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #0087ff;">num</span>=$<span style="color: #0087ff;">#</span>; <span style="color: #5f8700;">echo</span> ${<span style="color: #0087ff;">!</span>num}
<span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">&#19981;&#33021;&#30452;&#25509;&#20889;&#20316;${!$#}&#65292;&#36825;&#26159;&#19968;&#31181;**&#38388;&#25509;&#24341;&#29992;**</span>
<span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">ruanhao: ${$num}&#26159;&#19981;&#20801;&#35768;&#30340;&#65292;&#22240;&#20026;&#21464;&#37327;&#26367;&#25442;&#19981;&#33021;&#23884;&#22871;&#65292;</span>
<span style="color: #585858; font-style: italic;"># </span><span style="color: #585858; font-style: italic;">&#20294;&#26159;&#31867;&#20284;${var:$len}&#26159;&#21487;&#34892;&#30340;</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>