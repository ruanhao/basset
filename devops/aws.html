<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2019-04-23 Tue 22:30 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AWS</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Hao Ruan">
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link href="http://fonts.googleapis.com/css?family=Roboto+Slab:400,700|Inconsolata:400,700" rel="stylesheet" type="text/css" />
<link href="../org-html-themes/solarized/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">AWS</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org130bc77">1. EC2</a>
<ul>
<li><a href="#orgfa98536">1.1. Instance Families</a></li>
<li><a href="#org22dd371">1.2. User Data</a></li>
<li><a href="#org63b176e">1.3. CLI</a>
<ul>
<li><a href="#orgc95918d">1.3.1. list of running instances</a></li>
<li><a href="#org087bfcf">1.3.2. list of Images</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org08c7f53">2. Cloud Formation</a>
<ul>
<li><a href="#orgfeb0624">2.1. Parameters</a>
<ul>
<li><a href="#orga2e4d66">2.1.1. Valid types</a></li>
<li><a href="#orgc0288d7">2.1.2. Constraints</a></li>
</ul>
</li>
<li><a href="#org59a8fc5">2.2. Resources</a></li>
</ul>
</li>
<li><a href="#orgbc8a501">3. IAM</a>
<ul>
<li><a href="#orge4e853f">3.1. ARN</a></li>
<li><a href="#org4019cab">3.2. CLIs</a>
<ul>
<li><a href="#orgbb0202d">3.2.1. Get account id</a></li>
<li><a href="#org563a070">3.2.2. Create groud and user</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org53b7f23">4. Security Group</a>
<ul>
<li><a href="#orga771eef">4.1. Bastion Mode</a></li>
</ul>
</li>
<li><a href="#org97ffdf7">5. VPC</a>
<ul>
<li><a href="#org3c69526">5.1. ACL</a></li>
<li><a href="#org035d9bb">5.2. NAT Gateway</a></li>
</ul>
</li>
<li><a href="#org0377f6e">6. 参考资料</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="meta">
<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<tbody>
<tr>
<td class="org-left">Author</td>
<td class="org-left">Hao Ruan (haoru@cisco.com)</td>
</tr>

<tr>
<td class="org-left">Date</td>
<td class="org-left">2019-04-23 22:30:56</td>
</tr>
</tbody>
</table>
</div>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org130bc77">1. EC2</a>
<ul>
<li><a href="#orgfa98536">1.1. Instance Families</a></li>
<li><a href="#org22dd371">1.2. User Data</a></li>
<li><a href="#org63b176e">1.3. CLI</a>
<ul>
<li><a href="#orgc95918d">1.3.1. list of running instances</a></li>
<li><a href="#org087bfcf">1.3.2. list of Images</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org08c7f53">2. Cloud Formation</a>
<ul>
<li><a href="#orgfeb0624">2.1. Parameters</a>
<ul>
<li><a href="#orga2e4d66">2.1.1. Valid types</a></li>
<li><a href="#orgc0288d7">2.1.2. Constraints</a></li>
</ul>
</li>
<li><a href="#org59a8fc5">2.2. Resources</a></li>
</ul>
</li>
<li><a href="#orgbc8a501">3. IAM</a>
<ul>
<li><a href="#orge4e853f">3.1. ARN</a></li>
<li><a href="#org4019cab">3.2. CLIs</a>
<ul>
<li><a href="#orgbb0202d">3.2.1. Get account id</a></li>
<li><a href="#org563a070">3.2.2. Create groud and user</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org53b7f23">4. Security Group</a>
<ul>
<li><a href="#orga771eef">4.1. Bastion Mode</a></li>
</ul>
</li>
<li><a href="#org97ffdf7">5. VPC</a>
<ul>
<li><a href="#org3c69526">5.1. ACL</a></li>
<li><a href="#org035d9bb">5.2. NAT Gateway</a></li>
</ul>
</li>
<li><a href="#org0377f6e">6. 参考资料</a></li>
</ul>
</div>
</div>





<div id="outline-container-org130bc77" class="outline-2">
<h2 id="org130bc77"><span class="section-number-2">1</span> EC2</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgfa98536" class="outline-3">
<h3 id="orgfa98536"><span class="section-number-3">1.1</span> Instance Families</h3>
<div class="outline-text-3" id="text-1-1">

<div class="figure">
<p><img src="img/aws_instance_family_format.png" alt="aws_instance_family_format.png">
</p>
</div>

<ul class="org-ul">
<li>T family
Cheap, moderate baseline performance with the ability to burst to higher performance for short periods of time</li>
<li>M family
General purpose, with a balanced ration of CPU and memory</li>
<li>C family
Computing optimized, high CPU performance</li>
<li>R family
Memory optimized, with more memory than CPU power compared to M family</li>
<li>D family
Storage optimized, offering huge HDD capacity</li>
<li>I family
Storage optimized, offering huge SSD capacity</li>
<li>X family
Extensive capacity with a focus on memory, up to 1952 GB memory and 128 virtual cores</li>
<li>F family
Accelerated computing based on FPGAs</li>
<li>P, G, and CG family
Accelerated computing based on GPUs</li>
</ul>
</div>
</div>


<div id="outline-container-org22dd371" class="outline-3">
<h3 id="org22dd371"><span class="section-number-3">1.2</span> User Data</h3>
<div class="outline-text-3" id="text-1-2">
<p>
The user data is always accessible from the VM with a HTTP GET request to <code>http://169.254.169.254/latest/user-data</code> .
</p>
</div>
</div>

<div id="outline-container-org63b176e" class="outline-3">
<h3 id="org63b176e"><span class="section-number-3">1.3</span> CLI</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-orgc95918d" class="outline-4">
<h4 id="orgc95918d"><span class="section-number-4">1.3.1</span> list of running instances</h4>
<div class="outline-text-4" id="text-1-3-1">
<div class="org-src-container">
<pre class="src src-sh">aws ec2 describe-instances --filters <span style="color: #e6db74;">"Name=instance-type,Values=m4.xlarge"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org087bfcf" class="outline-4">
<h4 id="org087bfcf"><span class="section-number-4">1.3.2</span> list of Images</h4>
<div class="outline-text-4" id="text-1-3-2">
<div class="org-src-container">
<pre class="src src-sh">$ aws ec2 describe-images --query <span style="color: #e6db74;">"Images[0].ImageId"</span>
<span style="color: #e6db74;">"ami-146e2a7c"</span>
$ aws ec2 describe-images --query <span style="color: #e6db74;">"Images[0].ImageId"</span> --output text
ami-146e2a7c
$ aws ec2 describe-images --query <span style="color: #e6db74;">"Images[*].State"</span>
[<span style="color: #e6db74;">"available"</span>, <span style="color: #e6db74;">"available"</span>]
</pre>
</div>
</div>
</div>
</div>
</div>


<div id="outline-container-org08c7f53" class="outline-2">
<h2 id="org08c7f53"><span class="section-number-2">2</span> Cloud Formation</h2>
<div class="outline-text-2" id="text-2">
<p>
A basic CloudFormation template is structured into five parts:
</p>

<ol class="org-ol">
<li>Format version
The latest template format version is 2010-09-09</li>
<li>Description
What is this template about?</li>
<li>Parameters
Parameters are used to customize a template with values: for example, domain name, customer ID, and database password.</li>
<li>Resources
A resource is the smallest block you can describe. Examples are a virtual machine, a load balancer, or an Elastic IP address.</li>
<li>Outputs
An output returns something from your template, such as the public name of an EC2 instance.</li>
</ol>
</div>

<div id="outline-container-orgfeb0624" class="outline-3">
<h3 id="orgfeb0624"><span class="section-number-3">2.1</span> <a href="https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/parameters-section-structure.html">Parameters</a></h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #fd971f;">Parameters</span>:
  <span style="color: #fd971f;">KeyName</span>:
    <span style="color: #fd971f;">Description</span>: <span style="color: #e6db74;">'Key Pair name'</span>
    <span style="color: #fd971f;">Type</span>: <span style="color: #e6db74;">'AWS::EC2::KeyPair::KeyName'</span> <span style="color: #465457;"># </span><span style="color: #465457;">Only key pair names are allowed.</span>
  <span style="color: #fd971f;">NumberOfVirtualMachines</span>:
    <span style="color: #fd971f;">Description</span>: <span style="color: #e6db74;">'How many virtual machine do you like?'</span>
    <span style="color: #fd971f;">Type</span>: Number
    <span style="color: #fd971f;">Default</span>: 1 <span style="color: #465457;"># </span><span style="color: #465457;">The default is one virtual machine.</span>
    <span style="color: #fd971f;">MinValue</span>: 1
    <span style="color: #fd971f;">MaxValue</span>: 5 <span style="color: #465457;"># </span><span style="color: #465457;">Prevent massive costs with an upper bound.</span>
  <span style="color: #fd971f;">WordPressVersion</span>:
    <span style="color: #fd971f;">Description</span>: <span style="color: #e6db74;">'Which version of WordPress do you want?'</span>
    <span style="color: #fd971f;">Type</span>: String
    <span style="color: #fd971f;">AllowedValues</span>: [<span style="color: #e6db74;">'4.1.1'</span>, <span style="color: #e6db74;">'4.0.1'</span>] <span style="color: #465457;"># </span><span style="color: #465457;">Restricted to certain versions</span>
</pre>
</div>
</div>

<div id="outline-container-orga2e4d66" class="outline-4">
<h4 id="orga2e4d66"><span class="section-number-4">2.1.1</span> Valid types</h4>
<div class="outline-text-4" id="text-2-1-1">
<ul class="org-ul">
<li>String</li>
<li>Number</li>
<li>AWS::EC2::AvailabilityZone::Name
such as <code>us-west-2a</code></li>
<li>AWS::EC2::Image::Id</li>
<li>AWS::EC2::Instance::Id</li>
<li>AWS::EC2::KeyPair::KeyName</li>
<li>AWS::EC2::SecurityGroup::Id</li>
<li>AWS::EC2::Subnet::Id</li>
<li>AWS::EC2::Volume::Id
An EBS volume ID (network attached storage)</li>
<li>AWS::EC2::VPC::Id</li>
<li>AWS::Route53::HostedZone::Id
A DNS zone ID</li>
</ul>
</div>
</div>


<div id="outline-container-orgc0288d7" class="outline-4">
<h4 id="orgc0288d7"><span class="section-number-4">2.1.2</span> Constraints</h4>
<div class="outline-text-4" id="text-2-1-2">
<ul class="org-ul">
<li>Default</li>
<li>NoEcho</li>
<li>AllowedValues</li>
<li>AllowedPattern</li>
<li>MinLength, MaxLength</li>
<li>MinValue, MaxValue</li>
<li>ConstraintDescription</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-org59a8fc5" class="outline-3">
<h3 id="org59a8fc5"><span class="section-number-3">2.2</span> <a href="https://docs.aws.amazon.com/en_us/AWSCloudFormation/latest/UserGuide/aws-template-resource-type-ref.html">Resources</a></h3>
<div class="outline-text-3" id="text-2-2">
<p>
A resource has at least <span class="underline">a name</span>, <span class="underline">a type</span>, and <span class="underline">some properties</span>.
</p>
</div>
</div>
</div>



<div id="outline-container-orgbc8a501" class="outline-2">
<h2 id="orgbc8a501"><span class="section-number-2">3</span> IAM</h2>
<div class="outline-text-2" id="text-3">
<p>
IAM controls <b>who</b> (authentication) can do <b>what</b> (authorization) in your AWS account.
</p>


<div class="figure">
<p><img src="img/aws_iam_concepts.png" alt="aws_iam_concepts.png">
</p>
</div>

<ul class="org-ul">
<li>IAM user
Used to authenticate people accessing your AWS account.</li>
<li>IAM group
A collection of IAM users.</li>
<li>IAM role
Used to <span class="underline">authenticate AWS resources</span>, for example an EC2 instance.</li>
<li>IAM policy
Used to define the permissions for a user, group, or role.</li>
</ul>
</div>

<div id="outline-container-orge4e853f" class="outline-3">
<h3 id="orge4e853f"><span class="section-number-3">3.1</span> ARN</h3>
<div class="outline-text-3" id="text-3-1">

<div class="figure">
<p><img src="img/aws_arn.png" alt="aws_arn.png">
</p>
</div>
</div>
</div>



<div id="outline-container-org4019cab" class="outline-3">
<h3 id="org4019cab"><span class="section-number-3">3.2</span> CLIs</h3>
<div class="outline-text-3" id="text-3-2">
</div>
<div id="outline-container-orgbb0202d" class="outline-4">
<h4 id="orgbb0202d"><span class="section-number-4">3.2.1</span> Get account id</h4>
<div class="outline-text-4" id="text-3-2-1">
<div class="org-src-container">
<pre class="src src-sh">aws iam get-user --query <span style="color: #e6db74;">"User.Arn"</span> --output text
</pre>
</div>
</div>
</div>

<div id="outline-container-org563a070" class="outline-4">
<h4 id="org563a070"><span class="section-number-4">3.2.2</span> Create groud and user</h4>
<div class="outline-text-4" id="text-3-2-2">
<div class="org-src-container">
<pre class="src src-sh">aws iam create-group --group-name <span style="color: #e6db74;">"admin"</span>
aws iam attach-group-policy --group-name <span style="color: #e6db74;">"admin"</span> --policy-arn <span style="color: #e6db74;">"arn:aws:iam::aws:policy/AdministratorAccess"</span>
aws iam create-user --user-name <span style="color: #e6db74;">"myuser"</span>
aws iam add-user-to-group --group-name <span style="color: #e6db74;">"admin"</span> --user-name <span style="color: #e6db74;">"myuser"</span>
aws iam create-login-profile --user-name <span style="color: #e6db74;">"myuser"</span> --password <span style="color: #e6db74;">"$Password"</span>
</pre>
</div>
</div>
</div>
</div>
</div>


<div id="outline-container-org53b7f23" class="outline-2">
<h2 id="org53b7f23"><span class="section-number-2">4</span> Security Group</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-orga771eef" class="outline-3">
<h3 id="orga771eef"><span class="section-number-3">4.1</span> Bastion Mode</h3>
<div class="outline-text-3" id="text-4-1">

<div class="figure">
<p><img src="img/aws_bastion_mode.png" alt="aws_bastion_mode.png">
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-org97ffdf7" class="outline-2">
<h2 id="org97ffdf7"><span class="section-number-2">5</span> VPC</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org3c69526" class="outline-3">
<h3 id="org3c69526"><span class="section-number-3">5.1</span> ACL</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Network ACLs restrict traffic that goes from one subnet to another, acting as a firewall.
</p>

<pre class="example">
There's an important difference between security groups and ACLs: security groups are STATEFUL, but ACLs aren't.
If you allow an inbound port on a security group, the corresponding response to requests on that port are allowed as well.
That's not true for ACLs.

Security groups are tied to an instance, while Network ACL are tied to the subnet.
</pre>

<p>
<b>Recommend to start with using security groups to control traffic. If you want to add an extra layer of security, you should use ACL on top.</b>
</p>
</div>
</div>


<div id="outline-container-org035d9bb" class="outline-3">
<h3 id="org035d9bb"><span class="section-number-3">5.2</span> NAT Gateway</h3>
<div class="outline-text-3" id="text-5-2">

<div class="figure">
<p><img src="img/aws_nat.png" alt="aws_nat.png">
</p>
</div>


<ul class="org-ul">
<li>VPC 与 IGW 绑定</li>
<li>PrivateSubnet 默认路由指向 NATGateway</li>
<li>Instance 无需分配外网地址（即无法被外部访问）</li>
</ul>

<pre class="example">
  创建 VPC 时会生成默认路由表，Subnet 默认情况下将继承这个路由表，该路由表只有一条记录（ VPC 网段的 local 路由）。
  通常会自定义一个新的路由表给 Subnet 使用，该路由表被 attach 至 VPC （即包含 VPC 网段的 local 路由)，再添加一条指向 IGW 的 default 路由。
</pre>
</div>
</div>
</div>

<div id="outline-container-org0377f6e" class="outline-2">
<h2 id="org0377f6e"><span class="section-number-2">6</span> 参考资料</h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li><a href="https://github.com/AWSinAction/code2">AWS in Action</a></li>
</ul>
</div>
</div>
</div>
</body>
</html>